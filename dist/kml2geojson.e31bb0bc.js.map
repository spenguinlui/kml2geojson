{"version":3,"sources":["../lib/shared.js","../lib/gpx.js","../lib/tcx.js","../lib/kml.js","node_modules/xmldom/lib/entities.js","node_modules/xmldom/lib/sax.js","node_modules/xmldom/lib/dom.js","node_modules/xmldom/lib/dom-parser.js","index.js","../../../.config/yarn/global/node_modules/parcel-bundler/src/builtins/hmr-runtime.js"],"names":["nodeVal","x","normalize","textContent","get1","y","n","getElementsByTagName","length","getLineStyle","extensions","style","lineStyle","color","opacity","parseFloat","width","stroke","isNaN","getMulti","ys","o","k","getProperties","node","prop","getElementsByTagNameNS","i","extension","parentNode","tagName","replace","links","push","Object","assign","href","getAttribute","coordPair","ll","ele","heart","time","e","result","coordinates","extendedValues","name","v","getRoute","line","getPoints","type","properties","_gpxType","geometry","pointname","pts","times","c","j","val","plural","Array","fill","getTrack","segments","track","extractedLines","multi","coordinateProperties","entries","props","map","gpxGen","doc","tracks","routes","waypoints","feature","TRACKPOINT_ATTRIBUTES","LAP_ATTRIBUTES","attributeNames","tag","alias","elem","elements","lon","lat","alt","heartRate","a","heartRates","extendedProperties","value","getLap","allExtendedProperties","arr","obj","key","fromEntries","nameElement","property","tcxGen","laps","courses","removeSpace","trimSpace","splitSpace","okhash","h","charCodeAt","coord1","split","coord","xml2str","undefined","xml","output","attributes","childNodes","nodeName","nodeValue","trim","geotypes","kmlColor","prefix","colorProp","substr","parseInt","numericProperty","source","target","gxCoords","root","elems","coords","timeElems","getGeometry","geomNode","geomNodes","geoms","coordTimes","rings","getPlacemark","styleIndex","styleMapIndex","styleByHash","geomsAndTimes","address","styleUrl","description","timeSpan","timeStamp","extendedData","iconStyle","labelStyle","polyStyle","visibility","styleHash","styleMapHash","normal","begin","end","timespan","timestamp","hotspot","left","top","icon","outline","datas","simpleDatas","geometries","id","kmlGen","placemarks","styles","styleMaps","hash","toString","l","pairs","pairsMap","m","features","from","exports","entityMap","lt","gt","amp","quot","apos","Agrave","Aacute","Acirc","Atilde","Auml","Aring","AElig","Ccedil","Egrave","Eacute","Ecirc","Euml","Igrave","Iacute","Icirc","Iuml","ETH","Ntilde","Ograve","Oacute","Ocirc","Otilde","Ouml","Oslash","Ugrave","Uacute","Ucirc","Uuml","Yacute","THORN","szlig","agrave","aacute","acirc","atilde","auml","aring","aelig","ccedil","egrave","eacute","ecirc","euml","igrave","iacute","icirc","iuml","eth","ntilde","ograve","oacute","ocirc","otilde","ouml","oslash","ugrave","uacute","ucirc","uuml","yacute","thorn","yuml","nbsp","iexcl","cent","pound","curren","yen","brvbar","sect","uml","copy","ordf","laquo","not","shy","reg","macr","deg","plusmn","sup2","sup3","acute","micro","para","middot","cedil","sup1","ordm","raquo","frac14","frac12","frac34","iquest","divide","forall","part","exist","empty","nabla","isin","notin","ni","prod","sum","minus","lowast","radic","infin","ang","and","or","cap","cup","there4","sim","cong","asymp","ne","equiv","le","ge","sub","sup","nsub","sube","supe","oplus","otimes","perp","sdot","Alpha","Beta","Gamma","Delta","Epsilon","Zeta","Eta","Theta","Iota","Kappa","Lambda","Mu","Nu","Xi","Omicron","Pi","Rho","Sigma","Tau","Upsilon","Phi","Chi","Psi","Omega","alpha","beta","gamma","delta","epsilon","zeta","eta","theta","iota","kappa","lambda","mu","nu","xi","omicron","pi","rho","sigmaf","sigma","tau","upsilon","phi","chi","psi","omega","thetasym","upsih","piv","OElig","oelig","Scaron","scaron","Yuml","fnof","circ","tilde","ensp","emsp","thinsp","zwnj","zwj","lrm","rlm","ndash","mdash","lsquo","rsquo","sbquo","ldquo","rdquo","bdquo","dagger","Dagger","bull","hellip","permil","prime","Prime","lsaquo","rsaquo","oline","euro","trade","larr","uarr","rarr","darr","harr","crarr","lceil","rceil","lfloor","rfloor","loz","spades","clubs","hearts","diams","nameStartChar","nameChar","RegExp","slice","tagNamePattern","S_TAG","S_ATTR","S_ATTR_SPACE","S_EQ","S_ATTR_NOQUOT_VALUE","S_ATTR_END","S_TAG_SPACE","S_TAG_CLOSE","ParseError","message","locator","Error","captureStackTrace","prototype","XMLReader","parse","defaultNSMap","domBuilder","startDocument","_copy","errorHandler","endDocument","defaultNSMapCopy","fixedFromCharCode","code","surrogate1","surrogate2","String","fromCharCode","entityReplacer","charAt","error","appendText","start","xt","substring","position","characters","p","lineEnd","linePattern","exec","lineStart","index","lineNumber","columnNumber","parseStack","currentNSMap","closeMap","tagStart","indexOf","match","text","createTextNode","appendChild","currentElement","config","pop","localNSMap","endMatch","endIgnoreCaseMach","toLowerCase","endElement","uri","localName","endPrefixMapping","fatalError","parseInstruction","parseDCC","el","ElementAttributes","parseElementStartPart","len","closed","fixSelfClosed","warning","locator2","copyLocator","offset","appendElement","parseHtmlSpecialContent","Math","max","f","t","addAttribute","qname","startIndex","addValue","attrName","s","setTagName","qName","nsp","nsPrefix","startPrefixMapping","ns","startElement","elStartEnd","test","elEndStart","pos","lastIndexOf","next","comment","startCDATA","endCDATA","matchs","pubid","sysid","lastMatch","startDTD","endDTD","processingInstruction","getLocalName","getLocator","getQName","getURI","getValue","buf","lastIndex","src","dest","_extends","Class","Super","pt","constructor","console","htmlns","NodeType","ELEMENT_NODE","ATTRIBUTE_NODE","TEXT_NODE","CDATA_SECTION_NODE","ENTITY_REFERENCE_NODE","ENTITY_NODE","PROCESSING_INSTRUCTION_NODE","COMMENT_NODE","DOCUMENT_NODE","DOCUMENT_TYPE_NODE","DOCUMENT_FRAGMENT_NODE","NOTATION_NODE","ExceptionCode","ExceptionMessage","INDEX_SIZE_ERR","DOMSTRING_SIZE_ERR","HIERARCHY_REQUEST_ERR","WRONG_DOCUMENT_ERR","INVALID_CHARACTER_ERR","NO_DATA_ALLOWED_ERR","NO_MODIFICATION_ALLOWED_ERR","NOT_FOUND_ERR","NOT_SUPPORTED_ERR","INUSE_ATTRIBUTE_ERR","INVALID_STATE_ERR","SYNTAX_ERR","INVALID_MODIFICATION_ERR","NAMESPACE_ERR","INVALID_ACCESS_ERR","DOMException","call","NodeList","item","isHTML","nodeFilter","serializeToString","join","LiveNodeList","refresh","_node","_refresh","_updateLiveList","list","inc","_inc","ownerDocument","ls","__set__","NamedNodeMap","_findNodeIndex","_addNamedNode","newAttr","oldAttr","ownerElement","_onRemoveAttribute","_onAddAttribute","_removeNamedNode","attr","getNamedItem","setNamedItem","_ownerElement","setNamedItemNS","getNamedItemNS","namespaceURI","removeNamedItem","removeNamedItemNS","DOMImplementation","_features","hasFeature","version","versions","createDocument","qualifiedName","doctype","Document","implementation","createElementNS","createDocumentType","publicId","systemId","DocumentType","Node","firstChild","lastChild","previousSibling","nextSibling","insertBefore","newChild","refChild","_insertBefore","replaceChild","oldChild","removeChild","_removeChild","hasChildNodes","cloneNode","deep","child","nodeType","appendData","data","isSupported","hasAttributes","lookupPrefix","_nsMap","lookupNamespaceURI","isDefaultNamespace","_xmlEncoder","_visitNode","callback","remove","_onUpdateChild","cs","previous","nextChild","cp","newFirst","newLast","pre","_appendSingleChild","documentElement","importNode","importedNode","getElementById","rtv","getElementsByClassName","className","pattern","base","createElement","Element","attrs","createDocumentFragment","DocumentFragment","Text","createComment","Comment","createCDATASection","CDATASection","createProcessingInstruction","ProcessingInstruction","createAttribute","Attr","specified","createEntityReference","EntityReference","pl","createAttributeNS","hasAttribute","getAttributeNode","setAttribute","setAttributeNode","removeAttribute","removeAttributeNode","setAttributeNodeNS","removeAttributeNS","old","getAttributeNodeNS","hasAttributeNS","getAttributeNS","setAttributeNS","CharacterData","substringData","count","insertData","replaceData","deleteData","splitText","newText","newNode","Notation","Entity","XMLSerializer","isHtml","nodeSerializeToString","refNode","visibleNamespaces","namespace","needNamespaceDefine","startVisibleNamespaces","internalSubset","node2","attrs2","object","defineProperty","get","$$length","getTextContent","set","DOMParser","options","parseFromString","mimeType","sax","DOMHandler","xmlns","htmlEntity","setDocumentLocator","buildErrorHandler","errorImpl","isCallback","Function","build","fn","msg","_locator","cdata","documentURI","current","ins","ignorableWhitespace","ch","chars","_toString","apply","arguments","charNode","skippedEntity","comm","impl","dt","warn","java","lang","hander","require","__DOMHandler","converter","fs","downloadJson","dataStr","fileName","downloadDOM","document","body","click","convertKml2JSON","file","reader","FileReader","onload","xmlStr","parsedKML","geojson","kml","encodeURIComponent","JSON","stringify","readAsText","addEventListener","fileUploadInput","convertBtn","files","OVERLAY_ID","OldModule","module","bundle","Module","moduleName","hot","hotData","_acceptCallbacks","_disposeCallbacks","accept","dispose","checkedAssets","assetsToAccept","parent","isParcelRequire","WebSocket","hostname","location","protocol","ws","onmessage","event","handled","assets","forEach","asset","isNew","didAccept","hmrAcceptCheck","global","parcelRequire","every","generated","js","clear","hmrApply","hmrAcceptRun","reload","close","onclose","log","removeErrorOverlay","stack","overlay","createErrorOverlay","stackTrace","innerText","innerHTML","getParents","modules","parents","d","dep","isArray","concat","deps","cached","cache","some","cb"],"mappings":"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","file":"kml2geojson.e31bb0bc.js","sourceRoot":"..","sourcesContent":["// cast array x into numbers\n// get the content of a text node, if any\nexport function nodeVal(x) {\n  if (x && x.normalize) {\n    x.normalize();\n  }\n  return (x && x.textContent) || \"\";\n}\n\n// one Y child of X, if any, otherwise null\nexport function get1(x, y) {\n  const n = x.getElementsByTagName(y);\n  return n.length ? n[0] : null;\n}","import { nodeVal, get1 } from \"./shared\";\n\nfunction getLineStyle(extensions) {\n  const style = {};\n  if (extensions) {\n    const lineStyle = get1(extensions, \"line\");\n    if (lineStyle) {\n      const color = nodeVal(get1(lineStyle, \"color\")),\n        opacity = parseFloat(nodeVal(get1(lineStyle, \"opacity\"))),\n        width = parseFloat(nodeVal(get1(lineStyle, \"width\")));\n      if (color) style.stroke = color;\n      if (!isNaN(opacity)) style[\"stroke-opacity\"] = opacity;\n      // GPX width is in mm, convert to px with 96 px per inch\n      if (!isNaN(width)) style[\"stroke-width\"] = (width * 96) / 25.4;\n    }\n  }\n  return style;\n}\n\n// get the contents of multiple text nodes, if present\nfunction getMulti(x, ys) {\n  const o = {};\n  let n;\n  let k;\n  for (k = 0; k < ys.length; k++) {\n    n = get1(x, ys[k]);\n    if (n) o[ys[k]] = nodeVal(n);\n  }\n  return o;\n}\nfunction getProperties(node) {\n  const prop = getMulti(node, [\n    \"name\",\n    \"cmt\",\n    \"desc\",\n    \"type\",\n    \"time\",\n    \"keywords\",\n  ]);\n  // Parse additional data from our Garmin extension(s)\n  const extensions = node.getElementsByTagNameNS(\n    \"http://www.garmin.com/xmlschemas/GpxExtensions/v3\",\n    \"*\"\n  );\n  for (let i = 0; i < extensions.length; i++) {\n    const extension = extensions[i];\n    // Ignore nested extensions, like those on routepoints or trackpoints\n    if (extension.parentNode.parentNode === node) {\n      prop[extension.tagName.replace(\":\", \"_\")] = nodeVal(extension);\n    }\n  }\n  const links = node.getElementsByTagName(\"link\");\n  if (links.length) prop.links = [];\n  for (let i = 0; i < links.length; i++) {\n    prop.links.push(\n      Object.assign(\n        { href: links[i].getAttribute(\"href\") },\n        getMulti(links[i], [\"text\", \"type\"])\n      )\n    );\n  }\n  return prop;\n}\n\nfunction coordPair(x) {\n  const ll = [\n    parseFloat(x.getAttribute(\"lon\")),\n    parseFloat(x.getAttribute(\"lat\")),\n  ];\n  const ele = get1(x, \"ele\");\n  // handle namespaced attribute in browser\n  const heart = get1(x, \"gpxtpx:hr\") || get1(x, \"hr\");\n  const time = get1(x, \"time\");\n  let e;\n  if (ele) {\n    e = parseFloat(nodeVal(ele));\n    if (!isNaN(e)) {\n      ll.push(e);\n    }\n  }\n  const result = {\n    coordinates: ll,\n    time: time ? nodeVal(time) : null,\n    extendedValues: [],\n  };\n\n  if (heart) {\n    result.extendedValues.push([\"heart\", parseFloat(nodeVal(heart))]);\n  }\n\n  const extensions = get1(x, \"extensions\");\n  if (extensions !== null) {\n    for (const name of [\"speed\", \"course\", \"hAcc\", \"vAcc\"]) {\n      const v = parseFloat(nodeVal(get1(extensions, name)));\n      if (!isNaN(v)) {\n        result.extendedValues.push([name, v]);\n      }\n    }\n  }\n  return result;\n}\nfunction getRoute(node) {\n  const line = getPoints(node, \"rtept\");\n  if (!line) return;\n  return {\n    type: \"Feature\",\n    properties: Object.assign(\n      getProperties(node),\n      getLineStyle(get1(node, \"extensions\")),\n      { _gpxType: \"rte\" }\n    ),\n    geometry: {\n      type: \"LineString\",\n      coordinates: line.line,\n    },\n  };\n}\n\nfunction getPoints(node, pointname) {\n  const pts = node.getElementsByTagName(pointname);\n  if (pts.length < 2) return; // Invalid line in GeoJSON\n\n  const line = [];\n  const times = [];\n  const extendedValues = {};\n  for (let i = 0; i < pts.length; i++) {\n    const c = coordPair(pts[i]);\n    line.push(c.coordinates);\n    if (c.time) times.push(c.time);\n    for (let j = 0; j < c.extendedValues.length; j++) {\n      const [name, val] = c.extendedValues[j];\n      const plural = name === \"heart\" ? name : name + \"s\";\n      if (!extendedValues[plural]) {\n        extendedValues[plural] = Array(pts.length).fill(null);\n      }\n      extendedValues[plural][i] = val;\n    }\n  }\n  return {\n    line: line,\n    times: times,\n    extendedValues: extendedValues,\n  };\n}\n\nfunction getTrack(node) {\n  const segments = node.getElementsByTagName(\"trkseg\");\n  const track = [];\n  const times = [];\n  const extractedLines = [];\n\n  for (let i = 0; i < segments.length; i++) {\n    const line = getPoints(segments[i], \"trkpt\");\n    if (line) {\n      extractedLines.push(line);\n      if (line.times && line.times.length) times.push(line.times);\n    }\n  }\n\n  if (extractedLines.length === 0) return;\n\n  const multi = extractedLines.length > 1;\n\n  const properties = Object.assign(\n    getProperties(node),\n    getLineStyle(get1(node, \"extensions\")),\n    { _gpxType: \"trk\" },\n    times.length\n      ? {\n          coordinateProperties: {\n            times: multi ? times : times[0],\n          }\n        }\n      : {}\n  );\n\n  for (let i = 0; i < extractedLines.length; i++) {\n    const line = extractedLines[i];\n    track.push(line.line);\n    for (const [name, val] of Object.entries(line.extendedValues)) {\n      let props = properties;\n      if (name === \"heart\") {\n        if (!properties.coordinateProperties) {\n          properties.coordinateProperties = {};\n        }\n        props = properties.coordinateProperties;\n      }\n      if (multi) {\n        if (!props[name])\n          props[name] = extractedLines.map((line) =>\n            new Array(line.line.length).fill(null)\n          );\n        props[name][i] = val;\n      } else {\n        props[name] = val;\n      }\n    }\n  }\n\n  return {\n    type: \"Feature\",\n    properties: properties,\n    geometry: multi\n      ? {\n        type: \"MultiLineString\",\n        coordinates: track,\n      }\n      : {\n        type: \"LineString\",\n        coordinates: track[0],\n      },\n  };\n}\n\nfunction getPoint(node) {\n  return {\n    type: \"Feature\",\n    properties: Object.assign(getProperties(node), getMulti(node, [\"sym\"])),\n    geometry: {\n      type: \"Point\",\n      coordinates: coordPair(node).coordinates,\n    },\n  };\n}\n\nexport function* gpxGen(doc) {\n  const tracks = doc.getElementsByTagName(\"trk\");\n  const routes = doc.getElementsByTagName(\"rte\");\n  const waypoints = doc.getElementsByTagName(\"wpt\");\n\n  for (let i = 0; i < tracks.length; i++) {\n    const feature = getTrack(tracks[i]);\n    if (feature) yield feature;\n  }\n  for (let i = 0; i < routes.length; i++) {\n    const feature = getRoute(routes[i]);\n    if (feature) yield feature;\n  }\n  for (let i = 0; i < waypoints.length; i++) {\n    yield getPoint(waypoints[i]);\n  }\n}\n\nexport function gpx(doc) {\n  return {\n    type: \"FeatureCollection\",\n    features: Array.from(gpxGen(doc)),\n  };\n}\n","import { nodeVal, get1 } from \"./shared\";\n\nconst EXTENSIONS_NS = \"http://www.garmin.com/xmlschemas/ActivityExtension/v2\";\n\nconst TRACKPOINT_ATTRIBUTES = [\n  [\"heartRate\", \"heartRates\"],\n  [\"Cadence\", \"cadences\"],\n  // Extended Trackpoint attributes\n  [\"Speed\", \"speeds\"],\n  [\"Watts\", \"watts\"],\n];\n\nconst LAP_ATTRIBUTES = [\n  [\"TotalTimeSeconds\", \"totalTimeSeconds\"],\n  [\"DistanceMeters\", \"distanceMeters\"],\n  [\"MaximumSpeed\", \"maxSpeed\"],\n  [\"AverageHeartRateBpm\", \"avgHeartRate\"],\n  [\"MaximumHeartRateBpm\", \"maxHeartRate\"],\n\n  // Extended Lap attributes\n  [\"AvgSpeed\", \"avgSpeed\"],\n  [\"AvgWatts\", \"avgWatts\"],\n  [\"MaxWatts\", \"maxWatts\"],\n];\n\nfunction fromEntries(arr) {\n  const obj = {};\n  for (const [key, value] of arr) {\n    obj[key] = value;\n  }\n  return obj;\n}\n\nfunction getProperties(node, attributeNames) {\n  const properties = [];\n\n  for (const [tag, alias] of attributeNames) {\n    let elem = get1(node, tag);\n    if (!elem) {\n      const elements = node.getElementsByTagNameNS(EXTENSIONS_NS, tag);\n      if (elements.length) {\n        elem = elements[0];\n      }\n    }\n    const val = parseFloat(nodeVal(elem));\n    if (!isNaN(val)) {\n      properties.push([alias, val]);\n    }\n  }\n\n  return properties;\n}\n\nfunction coordPair(x) {\n  const lon = nodeVal(get1(x, \"LongitudeDegrees\"));\n  const lat = nodeVal(get1(x, \"LatitudeDegrees\"));\n  if (!lon.length || !lat.length) {\n    return null;\n  }\n  const ll = [parseFloat(lon), parseFloat(lat)];\n  const alt = get1(x, \"AltitudeMeters\");\n  const heartRate = get1(x, \"HeartRateBpm\");\n  const time = get1(x, \"Time\");\n  let a;\n  if (alt) {\n    a = parseFloat(nodeVal(alt));\n    if (!isNaN(a)) {\n      ll.push(a);\n    }\n  }\n  return {\n    coordinates: ll,\n    time: time ? nodeVal(time) : null,\n    heartRate: heartRate ? parseFloat(nodeVal(heartRate)) : null,\n    extensions: getProperties(x, TRACKPOINT_ATTRIBUTES),\n  };\n}\n\nfunction getPoints(node, pointname) {\n  const pts = node.getElementsByTagName(pointname);\n  const line = [];\n  const times = [];\n  const heartRates = [];\n  if (pts.length < 2) return null; // Invalid line in GeoJSON\n  const result = { extendedProperties: {} };\n  for (let i = 0; i < pts.length; i++) {\n    const c = coordPair(pts[i]);\n    if (c === null) continue;\n    line.push(c.coordinates);\n    if (c.time) times.push(c.time);\n    if (c.heartRate) heartRates.push(c.heartRate);\n    for (const [alias, value] of c.extensions) {\n      if (!result.extendedProperties[alias]) {\n        result.extendedProperties[alias] = Array(pts.length).fill(null);\n      }\n      result.extendedProperties[alias][i] = value;\n    }\n  }\n  return Object.assign(result, {\n    line: line,\n    times: times,\n    heartRates: heartRates,\n  });\n}\n\nfunction getLap(node) {\n  const segments = node.getElementsByTagName(\"Track\");\n  const track = [];\n  const times = [];\n  const heartRates = [];\n  const allExtendedProperties = [];\n  let line;\n  const properties = fromEntries(getProperties(node, LAP_ATTRIBUTES));\n\n  const nameElement = get1(node, 'Name')\n  if (nameElement) {\n    properties.name = nodeVal(nameElement)\n  }\n\n  for (let i = 0; i < segments.length; i++) {\n    line = getPoints(segments[i], \"Trackpoint\");\n    if (line) {\n      track.push(line.line);\n      if (line.times.length) times.push(line.times);\n      if (line.heartRates.length) heartRates.push(line.heartRates);\n      allExtendedProperties.push(line.extendedProperties);\n    }\n  }\n  for (let i = 0; i < allExtendedProperties.length; i++) {\n    const extendedProperties = allExtendedProperties[i];\n    for (const property in extendedProperties) {\n      if (segments.length === 1) {\n        properties[property] = line.extendedProperties[property];\n      } else {\n        if (!properties[property]) {\n          properties[property] = track.map((track) =>\n            Array(track.length).fill(null)\n          );\n        }\n        properties[property][i] = extendedProperties[property];\n      }\n    }\n  }\n  if (track.length === 0) return;\n\n  if (times.length || heartRates.length) {\n    properties.coordinateProperties = Object.assign(\n      times.length\n        ? {\n            times: track.length === 1 ? times[0] : times,\n          }\n        : {},\n      heartRates.length\n        ? {\n            heart: track.length === 1 ? heartRates[0] : heartRates,\n          }\n        : {}\n    );\n  }\n\n  return {\n    type: \"Feature\",\n    properties: properties,\n    geometry: {\n      type: track.length === 1 ? \"LineString\" : \"MultiLineString\",\n      coordinates: track.length === 1 ? track[0] : track,\n    },\n  };\n}\n\nexport function* tcxGen(doc) {\n  const laps = doc.getElementsByTagName(\"Lap\");\n\n  for (let i = 0; i < laps.length; i++) {\n    const feature = getLap(laps[i]);\n    if (feature) yield feature;\n  }\n\n  const courses = doc.getElementsByTagName(\"Courses\");\n\n  for (let i = 0; i < courses.length; i++) {\n    const feature = getLap(courses[i]);\n    if (feature) yield feature;\n  }\n}\n\nexport function tcx(doc) {\n  return {\n    type: \"FeatureCollection\",\n    features: Array.from(tcxGen(doc)),\n  };\n}\n","import { nodeVal, get1 } from \"./shared\";\n\nconst removeSpace = /\\s*/g;\nconst trimSpace = /^\\s*|\\s*$/g;\nconst splitSpace = /\\s+/;\n\n// generate a short, numeric hash of a string\nfunction okhash(x) {\n  if (!x || !x.length) return 0;\n  let h = 0;\n  for (let i = 0; i < x.length; i++) {\n    h = ((h << 5) - h + x.charCodeAt(i)) | 0;\n  }\n  return h;\n}\n\n// get one coordinate from a coordinate array, if any\nfunction coord1(v) {\n  return v.replace(removeSpace, \"\").split(\",\").map(parseFloat);\n}\n\n// get all coordinates from a coordinate array as [[],[]]\nfunction coord(v) {\n  return v.replace(trimSpace, \"\").split(splitSpace).map(coord1);\n}\n\nfunction xml2str(node) {\n  if (node.xml !== undefined) return node.xml;\n  if (node.tagName) {\n    let output = node.tagName;\n    for (let i = 0; i < node.attributes.length; i++) {\n      output += node.attributes[i].name + node.attributes[i].value;\n    }\n    for (let i = 0; i < node.childNodes.length; i++) {\n      output += xml2str(node.childNodes[i]);\n    }\n    return output;\n  }\n  if (node.nodeName === \"#text\") {\n    return (node.nodeValue || node.value || \"\").trim();\n  }\n  if (node.nodeName === \"#cdata-section\") {\n    return node.nodeValue;\n  }\n  return \"\";\n}\n\nconst geotypes = [\"Polygon\", \"LineString\", \"Point\", \"Track\", \"gx:Track\"];\n\nfunction kmlColor(properties, elem, prefix) {\n  let v = nodeVal(get1(elem, \"color\")) || \"\";\n  const colorProp =\n    prefix == \"stroke\" || prefix === \"fill\" ? prefix : prefix + \"-color\";\n  if (v.substr(0, 1) === \"#\") {\n    v = v.substr(1);\n  }\n  if (v.length === 6 || v.length === 3) {\n    properties[colorProp] = v;\n  } else if (v.length === 8) {\n    properties[prefix + \"-opacity\"] = parseInt(v.substr(0, 2), 16) / 255;\n    properties[colorProp] =\n      \"#\" + v.substr(6, 2) + v.substr(4, 2) + v.substr(2, 2);\n  }\n}\n\nfunction numericProperty(properties, elem, source, target) {\n  const val = parseFloat(nodeVal(get1(elem, source)));\n  if (!isNaN(val)) properties[target] = val;\n}\n\nfunction gxCoords(root) {\n  let elems = root.getElementsByTagName(\"coord\");\n  const coords = [];\n  const times = [];\n  if (elems.length === 0) elems = root.getElementsByTagName(\"gx:coord\");\n  for (let i = 0; i < elems.length; i++) {\n    coords.push(nodeVal(elems[i]).split(\" \").map(parseFloat));\n  }\n  const timeElems = root.getElementsByTagName(\"when\");\n  for (let j = 0; j < timeElems.length; j++) times.push(nodeVal(timeElems[j]));\n  return {\n    coords: coords,\n    times: times,\n  };\n}\n\nfunction getGeometry(root) {\n  let geomNode;\n  let geomNodes;\n  let i;\n  let j;\n  let k;\n  const geoms = [];\n  const coordTimes = [];\n  if (get1(root, \"MultiGeometry\")) {\n    return getGeometry(get1(root, \"MultiGeometry\"));\n  }\n  if (get1(root, \"MultiTrack\")) {\n    return getGeometry(get1(root, \"MultiTrack\"));\n  }\n  if (get1(root, \"gx:MultiTrack\")) {\n    return getGeometry(get1(root, \"gx:MultiTrack\"));\n  }\n  for (i = 0; i < geotypes.length; i++) {\n    geomNodes = root.getElementsByTagName(geotypes[i]);\n    if (geomNodes) {\n      for (j = 0; j < geomNodes.length; j++) {\n        geomNode = geomNodes[j];\n        if (geotypes[i] === \"Point\") {\n          geoms.push({\n            type: \"Point\",\n            coordinates: coord1(nodeVal(get1(geomNode, \"coordinates\"))),\n          });\n        } else if (geotypes[i] === \"LineString\") {\n          geoms.push({\n            type: \"LineString\",\n            coordinates: coord(nodeVal(get1(geomNode, \"coordinates\"))),\n          });\n        } else if (geotypes[i] === \"Polygon\") {\n          const rings = geomNode.getElementsByTagName(\"LinearRing\"),\n            coords = [];\n          for (k = 0; k < rings.length; k++) {\n            coords.push(coord(nodeVal(get1(rings[k], \"coordinates\"))));\n          }\n          geoms.push({\n            type: \"Polygon\",\n            coordinates: coords,\n          });\n        } else if (geotypes[i] === \"Track\" || geotypes[i] === \"gx:Track\") {\n          const track = gxCoords(geomNode);\n          geoms.push({\n            type: \"LineString\",\n            coordinates: track.coords,\n          });\n          if (track.times.length) coordTimes.push(track.times);\n        }\n      }\n    }\n  }\n  return {\n    geoms: geoms,\n    coordTimes: coordTimes,\n  };\n}\n\nfunction getPlacemark(root, styleIndex, styleMapIndex, styleByHash) {\n  const geomsAndTimes = getGeometry(root);\n  let i;\n  const properties = {};\n  const name = nodeVal(get1(root, \"name\"));\n  const address = nodeVal(get1(root, \"address\"));\n  let styleUrl = nodeVal(get1(root, \"styleUrl\"));\n  const description = nodeVal(get1(root, \"description\"));\n  const timeSpan = get1(root, \"TimeSpan\");\n  const timeStamp = get1(root, \"TimeStamp\");\n  const extendedData = get1(root, \"ExtendedData\");\n  let iconStyle = get1(root, \"IconStyle\");\n  let labelStyle = get1(root, \"LabelStyle\");\n  let lineStyle = get1(root, \"LineStyle\");\n  let polyStyle = get1(root, \"PolyStyle\");\n  const visibility = get1(root, \"visibility\");\n\n  if (name) properties.name = name;\n  if (address) properties.address = address;\n  if (styleUrl) {\n    if (styleUrl[0] !== \"#\") {\n      styleUrl = \"#\" + styleUrl;\n    }\n\n    properties.styleUrl = styleUrl;\n    if (styleIndex[styleUrl]) {\n      properties.styleHash = styleIndex[styleUrl];\n    }\n    if (styleMapIndex[styleUrl]) {\n      properties.styleMapHash = styleMapIndex[styleUrl];\n      properties.styleHash = styleIndex[styleMapIndex[styleUrl].normal];\n    }\n    // Try to populate the lineStyle or polyStyle since we got the style hash\n    const style = styleByHash[properties.styleHash];\n    if (style) {\n      if (!iconStyle) iconStyle = get1(style, \"IconStyle\");\n      if (!labelStyle) labelStyle = get1(style, \"LabelStyle\");\n      if (!lineStyle) lineStyle = get1(style, \"LineStyle\");\n      if (!polyStyle) polyStyle = get1(style, \"PolyStyle\");\n    }\n  }\n  if (description) properties.description = description;\n  if (timeSpan) {\n    const begin = nodeVal(get1(timeSpan, \"begin\"));\n    const end = nodeVal(get1(timeSpan, \"end\"));\n    properties.timespan = { begin: begin, end: end };\n  }\n  if (timeStamp) {\n    properties.timestamp = nodeVal(get1(timeStamp, \"when\"));\n  }\n  if (iconStyle) {\n    kmlColor(properties, iconStyle, \"icon\");\n    numericProperty(properties, iconStyle, \"scale\", \"icon-scale\");\n    numericProperty(properties, iconStyle, \"heading\", \"icon-heading\");\n\n    const hotspot = get1(iconStyle, \"hotSpot\");\n    if (hotspot) {\n      const left = parseFloat(hotspot.getAttribute(\"x\"));\n      const top = parseFloat(hotspot.getAttribute(\"y\"));\n      if (!isNaN(left) && !isNaN(top)) properties[\"icon-offset\"] = [left, top];\n    }\n    const icon = get1(iconStyle, \"Icon\");\n    if (icon) {\n      const href = nodeVal(get1(icon, \"href\"));\n      if (href) properties.icon = href;\n    }\n  }\n  if (labelStyle) {\n    kmlColor(properties, labelStyle, \"label\");\n    numericProperty(properties, labelStyle, \"scale\", \"label-scale\");\n  }\n  if (lineStyle) {\n    kmlColor(properties, lineStyle, \"stroke\");\n    numericProperty(properties, lineStyle, \"width\", \"stroke-width\");\n  }\n  if (polyStyle) {\n    kmlColor(properties, polyStyle, \"fill\");\n    const fill = nodeVal(get1(polyStyle, \"fill\"));\n    const outline = nodeVal(get1(polyStyle, \"outline\"));\n    if (fill)\n      properties[\"fill-opacity\"] =\n        fill === \"1\" ? properties[\"fill-opacity\"] || 1 : 0;\n    if (outline)\n      properties[\"stroke-opacity\"] =\n        outline === \"1\" ? properties[\"stroke-opacity\"] || 1 : 0;\n  }\n  if (extendedData) {\n    const datas = extendedData.getElementsByTagName(\"Data\"),\n      simpleDatas = extendedData.getElementsByTagName(\"SimpleData\");\n\n    for (i = 0; i < datas.length; i++) {\n      properties[datas[i].getAttribute(\"name\")] = nodeVal(\n        get1(datas[i], \"value\")\n      );\n    }\n    for (i = 0; i < simpleDatas.length; i++) {\n      properties[simpleDatas[i].getAttribute(\"name\")] = nodeVal(simpleDatas[i]);\n    }\n  }\n  if (visibility) {\n    properties.visibility = nodeVal(visibility);\n  }\n  if (geomsAndTimes.coordTimes.length) {\n    properties.coordinateProperties = {\n      times: geomsAndTimes.coordTimes.length === 1\n        ? geomsAndTimes.coordTimes[0]\n        : geomsAndTimes.coordTimes\n    };\n  }\n  const feature = {\n    type: \"Feature\",\n    geometry:\n      geomsAndTimes.geoms.length === 0\n        ? null\n        : geomsAndTimes.geoms.length === 1\n        ? geomsAndTimes.geoms[0]\n        : {\n            type: \"GeometryCollection\",\n            geometries: geomsAndTimes.geoms,\n          },\n    properties: properties,\n  };\n  if (root.getAttribute(\"id\")) feature.id = root.getAttribute(\"id\");\n  return feature;\n}\n\nexport function* kmlGen(doc) {\n  // styleindex keeps track of hashed styles in order to match feature\n  const styleIndex = {};\n  const styleByHash = {};\n  // stylemapindex keeps track of style maps to expose in properties\n  const styleMapIndex = {};\n  // atomic geospatial types supported by KML - MultiGeometry is\n  // handled separately\n  // all root placemarks in the file\n  const placemarks = doc.getElementsByTagName(\"Placemark\");\n  const styles = doc.getElementsByTagName(\"Style\");\n  const styleMaps = doc.getElementsByTagName(\"StyleMap\");\n\n  for (let k = 0; k < styles.length; k++) {\n    const hash = okhash(xml2str(styles[k])).toString(16);\n    styleIndex[\"#\" + styles[k].getAttribute(\"id\")] = hash;\n    styleByHash[hash] = styles[k];\n  }\n  for (let l = 0; l < styleMaps.length; l++) {\n    styleIndex[\"#\" + styleMaps[l].getAttribute(\"id\")] = okhash(\n      xml2str(styleMaps[l])\n    ).toString(16);\n    const pairs = styleMaps[l].getElementsByTagName(\"Pair\");\n    const pairsMap = {};\n    for (let m = 0; m < pairs.length; m++) {\n      pairsMap[nodeVal(get1(pairs[m], \"key\"))] = nodeVal(\n        get1(pairs[m], \"styleUrl\")\n      );\n    }\n    styleMapIndex[\"#\" + styleMaps[l].getAttribute(\"id\")] = pairsMap;\n  }\n  for (let j = 0; j < placemarks.length; j++) {\n    const feature = getPlacemark(\n      placemarks[j],\n      styleIndex,\n      styleMapIndex,\n      styleByHash\n    );\n    if (feature) yield feature;\n  }\n}\n\nexport function kml(doc) {\n  return {\n    type: \"FeatureCollection\",\n    features: Array.from(kmlGen(doc)),\n  };\n}\n","exports.entityMap = {\n       lt: '<',\n       gt: '>',\n       amp: '&',\n       quot: '\"',\n       apos: \"'\",\n       Agrave: \"À\",\n       Aacute: \"Á\",\n       Acirc: \"Â\",\n       Atilde: \"Ã\",\n       Auml: \"Ä\",\n       Aring: \"Å\",\n       AElig: \"Æ\",\n       Ccedil: \"Ç\",\n       Egrave: \"È\",\n       Eacute: \"É\",\n       Ecirc: \"Ê\",\n       Euml: \"Ë\",\n       Igrave: \"Ì\",\n       Iacute: \"Í\",\n       Icirc: \"Î\",\n       Iuml: \"Ï\",\n       ETH: \"Ð\",\n       Ntilde: \"Ñ\",\n       Ograve: \"Ò\",\n       Oacute: \"Ó\",\n       Ocirc: \"Ô\",\n       Otilde: \"Õ\",\n       Ouml: \"Ö\",\n       Oslash: \"Ø\",\n       Ugrave: \"Ù\",\n       Uacute: \"Ú\",\n       Ucirc: \"Û\",\n       Uuml: \"Ü\",\n       Yacute: \"Ý\",\n       THORN: \"Þ\",\n       szlig: \"ß\",\n       agrave: \"à\",\n       aacute: \"á\",\n       acirc: \"â\",\n       atilde: \"ã\",\n       auml: \"ä\",\n       aring: \"å\",\n       aelig: \"æ\",\n       ccedil: \"ç\",\n       egrave: \"è\",\n       eacute: \"é\",\n       ecirc: \"ê\",\n       euml: \"ë\",\n       igrave: \"ì\",\n       iacute: \"í\",\n       icirc: \"î\",\n       iuml: \"ï\",\n       eth: \"ð\",\n       ntilde: \"ñ\",\n       ograve: \"ò\",\n       oacute: \"ó\",\n       ocirc: \"ô\",\n       otilde: \"õ\",\n       ouml: \"ö\",\n       oslash: \"ø\",\n       ugrave: \"ù\",\n       uacute: \"ú\",\n       ucirc: \"û\",\n       uuml: \"ü\",\n       yacute: \"ý\",\n       thorn: \"þ\",\n       yuml: \"ÿ\",\n       nbsp: \"\\u00a0\",\n       iexcl: \"¡\",\n       cent: \"¢\",\n       pound: \"£\",\n       curren: \"¤\",\n       yen: \"¥\",\n       brvbar: \"¦\",\n       sect: \"§\",\n       uml: \"¨\",\n       copy: \"©\",\n       ordf: \"ª\",\n       laquo: \"«\",\n       not: \"¬\",\n       shy: \"­­\",\n       reg: \"®\",\n       macr: \"¯\",\n       deg: \"°\",\n       plusmn: \"±\",\n       sup2: \"²\",\n       sup3: \"³\",\n       acute: \"´\",\n       micro: \"µ\",\n       para: \"¶\",\n       middot: \"·\",\n       cedil: \"¸\",\n       sup1: \"¹\",\n       ordm: \"º\",\n       raquo: \"»\",\n       frac14: \"¼\",\n       frac12: \"½\",\n       frac34: \"¾\",\n       iquest: \"¿\",\n       times: \"×\",\n       divide: \"÷\",\n       forall: \"∀\",\n       part: \"∂\",\n       exist: \"∃\",\n       empty: \"∅\",\n       nabla: \"∇\",\n       isin: \"∈\",\n       notin: \"∉\",\n       ni: \"∋\",\n       prod: \"∏\",\n       sum: \"∑\",\n       minus: \"−\",\n       lowast: \"∗\",\n       radic: \"√\",\n       prop: \"∝\",\n       infin: \"∞\",\n       ang: \"∠\",\n       and: \"∧\",\n       or: \"∨\",\n       cap: \"∩\",\n       cup: \"∪\",\n       'int': \"∫\",\n       there4: \"∴\",\n       sim: \"∼\",\n       cong: \"≅\",\n       asymp: \"≈\",\n       ne: \"≠\",\n       equiv: \"≡\",\n       le: \"≤\",\n       ge: \"≥\",\n       sub: \"⊂\",\n       sup: \"⊃\",\n       nsub: \"⊄\",\n       sube: \"⊆\",\n       supe: \"⊇\",\n       oplus: \"⊕\",\n       otimes: \"⊗\",\n       perp: \"⊥\",\n       sdot: \"⋅\",\n       Alpha: \"Α\",\n       Beta: \"Β\",\n       Gamma: \"Γ\",\n       Delta: \"Δ\",\n       Epsilon: \"Ε\",\n       Zeta: \"Ζ\",\n       Eta: \"Η\",\n       Theta: \"Θ\",\n       Iota: \"Ι\",\n       Kappa: \"Κ\",\n       Lambda: \"Λ\",\n       Mu: \"Μ\",\n       Nu: \"Ν\",\n       Xi: \"Ξ\",\n       Omicron: \"Ο\",\n       Pi: \"Π\",\n       Rho: \"Ρ\",\n       Sigma: \"Σ\",\n       Tau: \"Τ\",\n       Upsilon: \"Υ\",\n       Phi: \"Φ\",\n       Chi: \"Χ\",\n       Psi: \"Ψ\",\n       Omega: \"Ω\",\n       alpha: \"α\",\n       beta: \"β\",\n       gamma: \"γ\",\n       delta: \"δ\",\n       epsilon: \"ε\",\n       zeta: \"ζ\",\n       eta: \"η\",\n       theta: \"θ\",\n       iota: \"ι\",\n       kappa: \"κ\",\n       lambda: \"λ\",\n       mu: \"μ\",\n       nu: \"ν\",\n       xi: \"ξ\",\n       omicron: \"ο\",\n       pi: \"π\",\n       rho: \"ρ\",\n       sigmaf: \"ς\",\n       sigma: \"σ\",\n       tau: \"τ\",\n       upsilon: \"υ\",\n       phi: \"φ\",\n       chi: \"χ\",\n       psi: \"ψ\",\n       omega: \"ω\",\n       thetasym: \"ϑ\",\n       upsih: \"ϒ\",\n       piv: \"ϖ\",\n       OElig: \"Œ\",\n       oelig: \"œ\",\n       Scaron: \"Š\",\n       scaron: \"š\",\n       Yuml: \"Ÿ\",\n       fnof: \"ƒ\",\n       circ: \"ˆ\",\n       tilde: \"˜\",\n       ensp: \" \",\n       emsp: \" \",\n       thinsp: \" \",\n       zwnj: \"‌\",\n       zwj: \"‍\",\n       lrm: \"‎\",\n       rlm: \"‏\",\n       ndash: \"–\",\n       mdash: \"—\",\n       lsquo: \"‘\",\n       rsquo: \"’\",\n       sbquo: \"‚\",\n       ldquo: \"“\",\n       rdquo: \"”\",\n       bdquo: \"„\",\n       dagger: \"†\",\n       Dagger: \"‡\",\n       bull: \"•\",\n       hellip: \"…\",\n       permil: \"‰\",\n       prime: \"′\",\n       Prime: \"″\",\n       lsaquo: \"‹\",\n       rsaquo: \"›\",\n       oline: \"‾\",\n       euro: \"€\",\n       trade: \"™\",\n       larr: \"←\",\n       uarr: \"↑\",\n       rarr: \"→\",\n       darr: \"↓\",\n       harr: \"↔\",\n       crarr: \"↵\",\n       lceil: \"⌈\",\n       rceil: \"⌉\",\n       lfloor: \"⌊\",\n       rfloor: \"⌋\",\n       loz: \"◊\",\n       spades: \"♠\",\n       clubs: \"♣\",\n       hearts: \"♥\",\n       diams: \"♦\"\n};\n","//[4]   \tNameStartChar\t   ::=   \t\":\" | [A-Z] | \"_\" | [a-z] | [#xC0-#xD6] | [#xD8-#xF6] | [#xF8-#x2FF] | [#x370-#x37D] | [#x37F-#x1FFF] | [#x200C-#x200D] | [#x2070-#x218F] | [#x2C00-#x2FEF] | [#x3001-#xD7FF] | [#xF900-#xFDCF] | [#xFDF0-#xFFFD] | [#x10000-#xEFFFF]\n//[4a]   \tNameChar\t   ::=   \tNameStartChar | \"-\" | \".\" | [0-9] | #xB7 | [#x0300-#x036F] | [#x203F-#x2040]\n//[5]   \tName\t   ::=   \tNameStartChar (NameChar)*\nvar nameStartChar = /[A-Z_a-z\\xC0-\\xD6\\xD8-\\xF6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD]///\\u10000-\\uEFFFF\nvar nameChar = new RegExp(\"[\\\\-\\\\.0-9\"+nameStartChar.source.slice(1,-1)+\"\\\\u00B7\\\\u0300-\\\\u036F\\\\u203F-\\\\u2040]\");\nvar tagNamePattern = new RegExp('^'+nameStartChar.source+nameChar.source+'*(?:\\:'+nameStartChar.source+nameChar.source+'*)?$');\n//var tagNamePattern = /^[a-zA-Z_][\\w\\-\\.]*(?:\\:[a-zA-Z_][\\w\\-\\.]*)?$/\n//var handlers = 'resolveEntity,getExternalSubset,characters,endDocument,endElement,endPrefixMapping,ignorableWhitespace,processingInstruction,setDocumentLocator,skippedEntity,startDocument,startElement,startPrefixMapping,notationDecl,unparsedEntityDecl,error,fatalError,warning,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,comment,endCDATA,endDTD,endEntity,startCDATA,startDTD,startEntity'.split(',')\n\n//S_TAG,\tS_ATTR,\tS_EQ,\tS_ATTR_NOQUOT_VALUE\n//S_ATTR_SPACE,\tS_ATTR_END,\tS_TAG_SPACE, S_TAG_CLOSE\nvar S_TAG = 0;//tag name offerring\nvar S_ATTR = 1;//attr name offerring \nvar S_ATTR_SPACE=2;//attr name end and space offer\nvar S_EQ = 3;//=space?\nvar S_ATTR_NOQUOT_VALUE = 4;//attr value(no quot value only)\nvar S_ATTR_END = 5;//attr value end and no space(quot end)\nvar S_TAG_SPACE = 6;//(attr value end || tag end ) && (space offer)\nvar S_TAG_CLOSE = 7;//closed el<el />\n\n/**\n * Creates an error that will not be caught by XMLReader aka the SAX parser.\n *\n * @param {string} message\n * @param {any?} locator Optional, can provide details about the location in the source\n * @constructor\n */\nfunction ParseError(message, locator) {\n\tthis.message = message\n\tthis.locator = locator\n\tif(Error.captureStackTrace) Error.captureStackTrace(this, ParseError);\n}\nParseError.prototype = new Error();\nParseError.prototype.name = ParseError.name\n\nfunction XMLReader(){\n\t\n}\n\nXMLReader.prototype = {\n\tparse:function(source,defaultNSMap,entityMap){\n\t\tvar domBuilder = this.domBuilder;\n\t\tdomBuilder.startDocument();\n\t\t_copy(defaultNSMap ,defaultNSMap = {})\n\t\tparse(source,defaultNSMap,entityMap,\n\t\t\t\tdomBuilder,this.errorHandler);\n\t\tdomBuilder.endDocument();\n\t}\n}\nfunction parse(source,defaultNSMapCopy,entityMap,domBuilder,errorHandler){\n\tfunction fixedFromCharCode(code) {\n\t\t// String.prototype.fromCharCode does not supports\n\t\t// > 2 bytes unicode chars directly\n\t\tif (code > 0xffff) {\n\t\t\tcode -= 0x10000;\n\t\t\tvar surrogate1 = 0xd800 + (code >> 10)\n\t\t\t\t, surrogate2 = 0xdc00 + (code & 0x3ff);\n\n\t\t\treturn String.fromCharCode(surrogate1, surrogate2);\n\t\t} else {\n\t\t\treturn String.fromCharCode(code);\n\t\t}\n\t}\n\tfunction entityReplacer(a){\n\t\tvar k = a.slice(1,-1);\n\t\tif(k in entityMap){\n\t\t\treturn entityMap[k]; \n\t\t}else if(k.charAt(0) === '#'){\n\t\t\treturn fixedFromCharCode(parseInt(k.substr(1).replace('x','0x')))\n\t\t}else{\n\t\t\terrorHandler.error('entity not found:'+a);\n\t\t\treturn a;\n\t\t}\n\t}\n\tfunction appendText(end){//has some bugs\n\t\tif(end>start){\n\t\t\tvar xt = source.substring(start,end).replace(/&#?\\w+;/g,entityReplacer);\n\t\t\tlocator&&position(start);\n\t\t\tdomBuilder.characters(xt,0,end-start);\n\t\t\tstart = end\n\t\t}\n\t}\n\tfunction position(p,m){\n\t\twhile(p>=lineEnd && (m = linePattern.exec(source))){\n\t\t\tlineStart = m.index;\n\t\t\tlineEnd = lineStart + m[0].length;\n\t\t\tlocator.lineNumber++;\n\t\t\t//console.log('line++:',locator,startPos,endPos)\n\t\t}\n\t\tlocator.columnNumber = p-lineStart+1;\n\t}\n\tvar lineStart = 0;\n\tvar lineEnd = 0;\n\tvar linePattern = /.*(?:\\r\\n?|\\n)|.*$/g\n\tvar locator = domBuilder.locator;\n\t\n\tvar parseStack = [{currentNSMap:defaultNSMapCopy}]\n\tvar closeMap = {};\n\tvar start = 0;\n\twhile(true){\n\t\ttry{\n\t\t\tvar tagStart = source.indexOf('<',start);\n\t\t\tif(tagStart<0){\n\t\t\t\tif(!source.substr(start).match(/^\\s*$/)){\n\t\t\t\t\tvar doc = domBuilder.doc;\n\t    \t\t\tvar text = doc.createTextNode(source.substr(start));\n\t    \t\t\tdoc.appendChild(text);\n\t    \t\t\tdomBuilder.currentElement = text;\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif(tagStart>start){\n\t\t\t\tappendText(tagStart);\n\t\t\t}\n\t\t\tswitch(source.charAt(tagStart+1)){\n\t\t\tcase '/':\n\t\t\t\tvar end = source.indexOf('>',tagStart+3);\n\t\t\t\tvar tagName = source.substring(tagStart+2,end);\n\t\t\t\tvar config = parseStack.pop();\n\t\t\t\tif(end<0){\n\t\t\t\t\t\n\t        \t\ttagName = source.substring(tagStart+2).replace(/[\\s<].*/,'');\n\t        \t\terrorHandler.error(\"end tag name: \"+tagName+' is not complete:'+config.tagName);\n\t        \t\tend = tagStart+1+tagName.length;\n\t        \t}else if(tagName.match(/\\s</)){\n\t        \t\ttagName = tagName.replace(/[\\s<].*/,'');\n\t        \t\terrorHandler.error(\"end tag name: \"+tagName+' maybe not complete');\n\t        \t\tend = tagStart+1+tagName.length;\n\t\t\t\t}\n\t\t\t\tvar localNSMap = config.localNSMap;\n\t\t\t\tvar endMatch = config.tagName == tagName;\n\t\t\t\tvar endIgnoreCaseMach = endMatch || config.tagName&&config.tagName.toLowerCase() == tagName.toLowerCase()\n\t\t        if(endIgnoreCaseMach){\n\t\t        \tdomBuilder.endElement(config.uri,config.localName,tagName);\n\t\t\t\t\tif(localNSMap){\n\t\t\t\t\t\tfor(var prefix in localNSMap){\n\t\t\t\t\t\t\tdomBuilder.endPrefixMapping(prefix) ;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(!endMatch){\n\t\t            \terrorHandler.fatalError(\"end tag name: \"+tagName+' is not match the current start tagName:'+config.tagName ); // No known test case\n\t\t\t\t\t}\n\t\t        }else{\n\t\t        \tparseStack.push(config)\n\t\t        }\n\t\t\t\t\n\t\t\t\tend++;\n\t\t\t\tbreak;\n\t\t\t\t// end elment\n\t\t\tcase '?':// <?...?>\n\t\t\t\tlocator&&position(tagStart);\n\t\t\t\tend = parseInstruction(source,tagStart,domBuilder);\n\t\t\t\tbreak;\n\t\t\tcase '!':// <!doctype,<![CDATA,<!--\n\t\t\t\tlocator&&position(tagStart);\n\t\t\t\tend = parseDCC(source,tagStart,domBuilder,errorHandler);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tlocator&&position(tagStart);\n\t\t\t\tvar el = new ElementAttributes();\n\t\t\t\tvar currentNSMap = parseStack[parseStack.length-1].currentNSMap;\n\t\t\t\t//elStartEnd\n\t\t\t\tvar end = parseElementStartPart(source,tagStart,el,currentNSMap,entityReplacer,errorHandler);\n\t\t\t\tvar len = el.length;\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tif(!el.closed && fixSelfClosed(source,end,el.tagName,closeMap)){\n\t\t\t\t\tel.closed = true;\n\t\t\t\t\tif(!entityMap.nbsp){\n\t\t\t\t\t\terrorHandler.warning('unclosed xml attribute');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(locator && len){\n\t\t\t\t\tvar locator2 = copyLocator(locator,{});\n\t\t\t\t\t//try{//attribute position fixed\n\t\t\t\t\tfor(var i = 0;i<len;i++){\n\t\t\t\t\t\tvar a = el[i];\n\t\t\t\t\t\tposition(a.offset);\n\t\t\t\t\t\ta.locator = copyLocator(locator,{});\n\t\t\t\t\t}\n\t\t\t\t\tdomBuilder.locator = locator2\n\t\t\t\t\tif(appendElement(el,domBuilder,currentNSMap)){\n\t\t\t\t\t\tparseStack.push(el)\n\t\t\t\t\t}\n\t\t\t\t\tdomBuilder.locator = locator;\n\t\t\t\t}else{\n\t\t\t\t\tif(appendElement(el,domBuilder,currentNSMap)){\n\t\t\t\t\t\tparseStack.push(el)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tif(el.uri === 'http://www.w3.org/1999/xhtml' && !el.closed){\n\t\t\t\t\tend = parseHtmlSpecialContent(source,end,el.tagName,entityReplacer,domBuilder)\n\t\t\t\t}else{\n\t\t\t\t\tend++;\n\t\t\t\t}\n\t\t\t}\n\t\t}catch(e){\n\t\t\tif (e instanceof ParseError) {\n\t\t\t\tthrow e;\n\t\t\t}\n\t\t\terrorHandler.error('element parse error: '+e)\n\t\t\tend = -1;\n\t\t}\n\t\tif(end>start){\n\t\t\tstart = end;\n\t\t}else{\n\t\t\t//TODO: 这里有可能sax回退，有位置错误风险\n\t\t\tappendText(Math.max(tagStart,start)+1);\n\t\t}\n\t}\n}\nfunction copyLocator(f,t){\n\tt.lineNumber = f.lineNumber;\n\tt.columnNumber = f.columnNumber;\n\treturn t;\n}\n\n/**\n * @see #appendElement(source,elStartEnd,el,selfClosed,entityReplacer,domBuilder,parseStack);\n * @return end of the elementStartPart(end of elementEndPart for selfClosed el)\n */\nfunction parseElementStartPart(source,start,el,currentNSMap,entityReplacer,errorHandler){\n\n\t/**\n\t * @param {string} qname\n\t * @param {string} value\n\t * @param {number} startIndex\n\t */\n\tfunction addAttribute(qname, value, startIndex) {\n\t\tif (qname in el.attributeNames) errorHandler.fatalError('Attribute ' + qname + ' redefined')\n\t\tel.addValue(qname, value, startIndex)\n\t}\n\tvar attrName;\n\tvar value;\n\tvar p = ++start;\n\tvar s = S_TAG;//status\n\twhile(true){\n\t\tvar c = source.charAt(p);\n\t\tswitch(c){\n\t\tcase '=':\n\t\t\tif(s === S_ATTR){//attrName\n\t\t\t\tattrName = source.slice(start,p);\n\t\t\t\ts = S_EQ;\n\t\t\t}else if(s === S_ATTR_SPACE){\n\t\t\t\ts = S_EQ;\n\t\t\t}else{\n\t\t\t\t//fatalError: equal must after attrName or space after attrName\n\t\t\t\tthrow new Error('attribute equal must after attrName'); // No known test case\n\t\t\t}\n\t\t\tbreak;\n\t\tcase '\\'':\n\t\tcase '\"':\n\t\t\tif(s === S_EQ || s === S_ATTR //|| s == S_ATTR_SPACE\n\t\t\t\t){//equal\n\t\t\t\tif(s === S_ATTR){\n\t\t\t\t\terrorHandler.warning('attribute value must after \"=\"')\n\t\t\t\t\tattrName = source.slice(start,p)\n\t\t\t\t}\n\t\t\t\tstart = p+1;\n\t\t\t\tp = source.indexOf(c,start)\n\t\t\t\tif(p>0){\n\t\t\t\t\tvalue = source.slice(start,p).replace(/&#?\\w+;/g,entityReplacer);\n\t\t\t\t\taddAttribute(attrName, value, start-1);\n\t\t\t\t\ts = S_ATTR_END;\n\t\t\t\t}else{\n\t\t\t\t\t//fatalError: no end quot match\n\t\t\t\t\tthrow new Error('attribute value no end \\''+c+'\\' match');\n\t\t\t\t}\n\t\t\t}else if(s == S_ATTR_NOQUOT_VALUE){\n\t\t\t\tvalue = source.slice(start,p).replace(/&#?\\w+;/g,entityReplacer);\n\t\t\t\t//console.log(attrName,value,start,p)\n\t\t\t\taddAttribute(attrName, value, start);\n\t\t\t\t//console.dir(el)\n\t\t\t\terrorHandler.warning('attribute \"'+attrName+'\" missed start quot('+c+')!!');\n\t\t\t\tstart = p+1;\n\t\t\t\ts = S_ATTR_END\n\t\t\t}else{\n\t\t\t\t//fatalError: no equal before\n\t\t\t\tthrow new Error('attribute value must after \"=\"'); // No known test case\n\t\t\t}\n\t\t\tbreak;\n\t\tcase '/':\n\t\t\tswitch(s){\n\t\t\tcase S_TAG:\n\t\t\t\tel.setTagName(source.slice(start,p));\n\t\t\tcase S_ATTR_END:\n\t\t\tcase S_TAG_SPACE:\n\t\t\tcase S_TAG_CLOSE:\n\t\t\t\ts =S_TAG_CLOSE;\n\t\t\t\tel.closed = true;\n\t\t\tcase S_ATTR_NOQUOT_VALUE:\n\t\t\tcase S_ATTR:\n\t\t\tcase S_ATTR_SPACE:\n\t\t\t\tbreak;\n\t\t\t//case S_EQ:\n\t\t\tdefault:\n\t\t\t\tthrow new Error(\"attribute invalid close char('/')\") // No known test case\n\t\t\t}\n\t\t\tbreak;\n\t\tcase ''://end document\n\t\t\terrorHandler.error('unexpected end of input');\n\t\t\tif(s == S_TAG){\n\t\t\t\tel.setTagName(source.slice(start,p));\n\t\t\t}\n\t\t\treturn p;\n\t\tcase '>':\n\t\t\tswitch(s){\n\t\t\tcase S_TAG:\n\t\t\t\tel.setTagName(source.slice(start,p));\n\t\t\tcase S_ATTR_END:\n\t\t\tcase S_TAG_SPACE:\n\t\t\tcase S_TAG_CLOSE:\n\t\t\t\tbreak;//normal\n\t\t\tcase S_ATTR_NOQUOT_VALUE://Compatible state\n\t\t\tcase S_ATTR:\n\t\t\t\tvalue = source.slice(start,p);\n\t\t\t\tif(value.slice(-1) === '/'){\n\t\t\t\t\tel.closed  = true;\n\t\t\t\t\tvalue = value.slice(0,-1)\n\t\t\t\t}\n\t\t\tcase S_ATTR_SPACE:\n\t\t\t\tif(s === S_ATTR_SPACE){\n\t\t\t\t\tvalue = attrName;\n\t\t\t\t}\n\t\t\t\tif(s == S_ATTR_NOQUOT_VALUE){\n\t\t\t\t\terrorHandler.warning('attribute \"'+value+'\" missed quot(\")!');\n\t\t\t\t\taddAttribute(attrName, value.replace(/&#?\\w+;/g,entityReplacer), start)\n\t\t\t\t}else{\n\t\t\t\t\tif(currentNSMap[''] !== 'http://www.w3.org/1999/xhtml' || !value.match(/^(?:disabled|checked|selected)$/i)){\n\t\t\t\t\t\terrorHandler.warning('attribute \"'+value+'\" missed value!! \"'+value+'\" instead!!')\n\t\t\t\t\t}\n\t\t\t\t\taddAttribute(value, value, start)\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase S_EQ:\n\t\t\t\tthrow new Error('attribute value missed!!');\n\t\t\t}\n//\t\t\tconsole.log(tagName,tagNamePattern,tagNamePattern.test(tagName))\n\t\t\treturn p;\n\t\t/*xml space '\\x20' | #x9 | #xD | #xA; */\n\t\tcase '\\u0080':\n\t\t\tc = ' ';\n\t\tdefault:\n\t\t\tif(c<= ' '){//space\n\t\t\t\tswitch(s){\n\t\t\t\tcase S_TAG:\n\t\t\t\t\tel.setTagName(source.slice(start,p));//tagName\n\t\t\t\t\ts = S_TAG_SPACE;\n\t\t\t\t\tbreak;\n\t\t\t\tcase S_ATTR:\n\t\t\t\t\tattrName = source.slice(start,p)\n\t\t\t\t\ts = S_ATTR_SPACE;\n\t\t\t\t\tbreak;\n\t\t\t\tcase S_ATTR_NOQUOT_VALUE:\n\t\t\t\t\tvar value = source.slice(start,p).replace(/&#?\\w+;/g,entityReplacer);\n\t\t\t\t\terrorHandler.warning('attribute \"'+value+'\" missed quot(\")!!');\n\t\t\t\t\taddAttribute(attrName, value, start)\n\t\t\t\tcase S_ATTR_END:\n\t\t\t\t\ts = S_TAG_SPACE;\n\t\t\t\t\tbreak;\n\t\t\t\t//case S_TAG_SPACE:\n\t\t\t\t//case S_EQ:\n\t\t\t\t//case S_ATTR_SPACE:\n\t\t\t\t//\tvoid();break;\n\t\t\t\t//case S_TAG_CLOSE:\n\t\t\t\t\t//ignore warning\n\t\t\t\t}\n\t\t\t}else{//not space\n//S_TAG,\tS_ATTR,\tS_EQ,\tS_ATTR_NOQUOT_VALUE\n//S_ATTR_SPACE,\tS_ATTR_END,\tS_TAG_SPACE, S_TAG_CLOSE\n\t\t\t\tswitch(s){\n\t\t\t\t//case S_TAG:void();break;\n\t\t\t\t//case S_ATTR:void();break;\n\t\t\t\t//case S_ATTR_NOQUOT_VALUE:void();break;\n\t\t\t\tcase S_ATTR_SPACE:\n\t\t\t\t\tvar tagName =  el.tagName;\n\t\t\t\t\tif(currentNSMap[''] !== 'http://www.w3.org/1999/xhtml' || !attrName.match(/^(?:disabled|checked|selected)$/i)){\n\t\t\t\t\t\terrorHandler.warning('attribute \"'+attrName+'\" missed value!! \"'+attrName+'\" instead2!!')\n\t\t\t\t\t}\n\t\t\t\t\taddAttribute(attrName, attrName, start);\n\t\t\t\t\tstart = p;\n\t\t\t\t\ts = S_ATTR;\n\t\t\t\t\tbreak;\n\t\t\t\tcase S_ATTR_END:\n\t\t\t\t\terrorHandler.warning('attribute space is required\"'+attrName+'\"!!')\n\t\t\t\tcase S_TAG_SPACE:\n\t\t\t\t\ts = S_ATTR;\n\t\t\t\t\tstart = p;\n\t\t\t\t\tbreak;\n\t\t\t\tcase S_EQ:\n\t\t\t\t\ts = S_ATTR_NOQUOT_VALUE;\n\t\t\t\t\tstart = p;\n\t\t\t\t\tbreak;\n\t\t\t\tcase S_TAG_CLOSE:\n\t\t\t\t\tthrow new Error(\"elements closed character '/' and '>' must be connected to\");\n\t\t\t\t}\n\t\t\t}\n\t\t}//end outer switch\n\t\t//console.log('p++',p)\n\t\tp++;\n\t}\n}\n/**\n * @return true if has new namespace define\n */\nfunction appendElement(el,domBuilder,currentNSMap){\n\tvar tagName = el.tagName;\n\tvar localNSMap = null;\n\t//var currentNSMap = parseStack[parseStack.length-1].currentNSMap;\n\tvar i = el.length;\n\twhile(i--){\n\t\tvar a = el[i];\n\t\tvar qName = a.qName;\n\t\tvar value = a.value;\n\t\tvar nsp = qName.indexOf(':');\n\t\tif(nsp>0){\n\t\t\tvar prefix = a.prefix = qName.slice(0,nsp);\n\t\t\tvar localName = qName.slice(nsp+1);\n\t\t\tvar nsPrefix = prefix === 'xmlns' && localName\n\t\t}else{\n\t\t\tlocalName = qName;\n\t\t\tprefix = null\n\t\t\tnsPrefix = qName === 'xmlns' && ''\n\t\t}\n\t\t//can not set prefix,because prefix !== ''\n\t\ta.localName = localName ;\n\t\t//prefix == null for no ns prefix attribute \n\t\tif(nsPrefix !== false){//hack!!\n\t\t\tif(localNSMap == null){\n\t\t\t\tlocalNSMap = {}\n\t\t\t\t//console.log(currentNSMap,0)\n\t\t\t\t_copy(currentNSMap,currentNSMap={})\n\t\t\t\t//console.log(currentNSMap,1)\n\t\t\t}\n\t\t\tcurrentNSMap[nsPrefix] = localNSMap[nsPrefix] = value;\n\t\t\ta.uri = 'http://www.w3.org/2000/xmlns/'\n\t\t\tdomBuilder.startPrefixMapping(nsPrefix, value) \n\t\t}\n\t}\n\tvar i = el.length;\n\twhile(i--){\n\t\ta = el[i];\n\t\tvar prefix = a.prefix;\n\t\tif(prefix){//no prefix attribute has no namespace\n\t\t\tif(prefix === 'xml'){\n\t\t\t\ta.uri = 'http://www.w3.org/XML/1998/namespace';\n\t\t\t}if(prefix !== 'xmlns'){\n\t\t\t\ta.uri = currentNSMap[prefix || '']\n\t\t\t\t\n\t\t\t\t//{console.log('###'+a.qName,domBuilder.locator.systemId+'',currentNSMap,a.uri)}\n\t\t\t}\n\t\t}\n\t}\n\tvar nsp = tagName.indexOf(':');\n\tif(nsp>0){\n\t\tprefix = el.prefix = tagName.slice(0,nsp);\n\t\tlocalName = el.localName = tagName.slice(nsp+1);\n\t}else{\n\t\tprefix = null;//important!!\n\t\tlocalName = el.localName = tagName;\n\t}\n\t//no prefix element has default namespace\n\tvar ns = el.uri = currentNSMap[prefix || ''];\n\tdomBuilder.startElement(ns,localName,tagName,el);\n\t//endPrefixMapping and startPrefixMapping have not any help for dom builder\n\t//localNSMap = null\n\tif(el.closed){\n\t\tdomBuilder.endElement(ns,localName,tagName);\n\t\tif(localNSMap){\n\t\t\tfor(prefix in localNSMap){\n\t\t\t\tdomBuilder.endPrefixMapping(prefix) \n\t\t\t}\n\t\t}\n\t}else{\n\t\tel.currentNSMap = currentNSMap;\n\t\tel.localNSMap = localNSMap;\n\t\t//parseStack.push(el);\n\t\treturn true;\n\t}\n}\nfunction parseHtmlSpecialContent(source,elStartEnd,tagName,entityReplacer,domBuilder){\n\tif(/^(?:script|textarea)$/i.test(tagName)){\n\t\tvar elEndStart =  source.indexOf('</'+tagName+'>',elStartEnd);\n\t\tvar text = source.substring(elStartEnd+1,elEndStart);\n\t\tif(/[&<]/.test(text)){\n\t\t\tif(/^script$/i.test(tagName)){\n\t\t\t\t//if(!/\\]\\]>/.test(text)){\n\t\t\t\t\t//lexHandler.startCDATA();\n\t\t\t\t\tdomBuilder.characters(text,0,text.length);\n\t\t\t\t\t//lexHandler.endCDATA();\n\t\t\t\t\treturn elEndStart;\n\t\t\t\t//}\n\t\t\t}//}else{//text area\n\t\t\t\ttext = text.replace(/&#?\\w+;/g,entityReplacer);\n\t\t\t\tdomBuilder.characters(text,0,text.length);\n\t\t\t\treturn elEndStart;\n\t\t\t//}\n\t\t\t\n\t\t}\n\t}\n\treturn elStartEnd+1;\n}\nfunction fixSelfClosed(source,elStartEnd,tagName,closeMap){\n\t//if(tagName in closeMap){\n\tvar pos = closeMap[tagName];\n\tif(pos == null){\n\t\t//console.log(tagName)\n\t\tpos =  source.lastIndexOf('</'+tagName+'>')\n\t\tif(pos<elStartEnd){//忘记闭合\n\t\t\tpos = source.lastIndexOf('</'+tagName)\n\t\t}\n\t\tcloseMap[tagName] =pos\n\t}\n\treturn pos<elStartEnd;\n\t//} \n}\nfunction _copy(source,target){\n\tfor(var n in source){target[n] = source[n]}\n}\nfunction parseDCC(source,start,domBuilder,errorHandler){//sure start with '<!'\n\tvar next= source.charAt(start+2)\n\tswitch(next){\n\tcase '-':\n\t\tif(source.charAt(start + 3) === '-'){\n\t\t\tvar end = source.indexOf('-->',start+4);\n\t\t\t//append comment source.substring(4,end)//<!--\n\t\t\tif(end>start){\n\t\t\t\tdomBuilder.comment(source,start+4,end-start-4);\n\t\t\t\treturn end+3;\n\t\t\t}else{\n\t\t\t\terrorHandler.error(\"Unclosed comment\");\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t}else{\n\t\t\t//error\n\t\t\treturn -1;\n\t\t}\n\tdefault:\n\t\tif(source.substr(start+3,6) == 'CDATA['){\n\t\t\tvar end = source.indexOf(']]>',start+9);\n\t\t\tdomBuilder.startCDATA();\n\t\t\tdomBuilder.characters(source,start+9,end-start-9);\n\t\t\tdomBuilder.endCDATA() \n\t\t\treturn end+3;\n\t\t}\n\t\t//<!DOCTYPE\n\t\t//startDTD(java.lang.String name, java.lang.String publicId, java.lang.String systemId) \n\t\tvar matchs = split(source,start);\n\t\tvar len = matchs.length;\n\t\tif(len>1 && /!doctype/i.test(matchs[0][0])){\n\t\t\tvar name = matchs[1][0];\n\t\t\tvar pubid = false;\n\t\t\tvar sysid = false;\n\t\t\tif(len>3){\n\t\t\t\tif(/^public$/i.test(matchs[2][0])){\n\t\t\t\t\tpubid = matchs[3][0];\n\t\t\t\t\tsysid = len>4 && matchs[4][0];\n\t\t\t\t}else if(/^system$/i.test(matchs[2][0])){\n\t\t\t\t\tsysid = matchs[3][0];\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar lastMatch = matchs[len-1]\n\t\t\tdomBuilder.startDTD(name, pubid, sysid);\n\t\t\tdomBuilder.endDTD();\n\t\t\t\n\t\t\treturn lastMatch.index+lastMatch[0].length\n\t\t}\n\t}\n\treturn -1;\n}\n\n\n\nfunction parseInstruction(source,start,domBuilder){\n\tvar end = source.indexOf('?>',start);\n\tif(end){\n\t\tvar match = source.substring(start,end).match(/^<\\?(\\S*)\\s*([\\s\\S]*?)\\s*$/);\n\t\tif(match){\n\t\t\tvar len = match[0].length;\n\t\t\tdomBuilder.processingInstruction(match[1], match[2]) ;\n\t\t\treturn end+2;\n\t\t}else{//error\n\t\t\treturn -1;\n\t\t}\n\t}\n\treturn -1;\n}\n\nfunction ElementAttributes(){\n\tthis.attributeNames = {}\n}\nElementAttributes.prototype = {\n\tsetTagName:function(tagName){\n\t\tif(!tagNamePattern.test(tagName)){\n\t\t\tthrow new Error('invalid tagName:'+tagName)\n\t\t}\n\t\tthis.tagName = tagName\n\t},\n\taddValue:function(qName, value, offset) {\n\t\tif(!tagNamePattern.test(qName)){\n\t\t\tthrow new Error('invalid attribute:'+qName)\n\t\t}\n\t\tthis.attributeNames[qName] = this.length;\n\t\tthis[this.length++] = {qName:qName,value:value,offset:offset}\n\t},\n\tlength:0,\n\tgetLocalName:function(i){return this[i].localName},\n\tgetLocator:function(i){return this[i].locator},\n\tgetQName:function(i){return this[i].qName},\n\tgetURI:function(i){return this[i].uri},\n\tgetValue:function(i){return this[i].value}\n//\t,getIndex:function(uri, localName)){\n//\t\tif(localName){\n//\t\t\t\n//\t\t}else{\n//\t\t\tvar qName = uri\n//\t\t}\n//\t},\n//\tgetValue:function(){return this.getValue(this.getIndex.apply(this,arguments))},\n//\tgetType:function(uri,localName){}\n//\tgetType:function(i){},\n}\n\n\n\nfunction split(source,start){\n\tvar match;\n\tvar buf = [];\n\tvar reg = /'[^']+'|\"[^\"]+\"|[^\\s<>\\/=]+=?|(\\/?\\s*>|<)/g;\n\treg.lastIndex = start;\n\treg.exec(source);//skip <\n\twhile(match = reg.exec(source)){\n\t\tbuf.push(match);\n\t\tif(match[1])return buf;\n\t}\n}\n\nexports.XMLReader = XMLReader;\nexports.ParseError = ParseError;\n","function copy(src,dest){\n\tfor(var p in src){\n\t\tdest[p] = src[p];\n\t}\n}\n/**\n^\\w+\\.prototype\\.([_\\w]+)\\s*=\\s*((?:.*\\{\\s*?[\\r\\n][\\s\\S]*?^})|\\S.*?(?=[;\\r\\n]));?\n^\\w+\\.prototype\\.([_\\w]+)\\s*=\\s*(\\S.*?(?=[;\\r\\n]));?\n */\nfunction _extends(Class,Super){\n\tvar pt = Class.prototype;\n\tif(!(pt instanceof Super)){\n\t\tfunction t(){};\n\t\tt.prototype = Super.prototype;\n\t\tt = new t();\n\t\tcopy(pt,t);\n\t\tClass.prototype = pt = t;\n\t}\n\tif(pt.constructor != Class){\n\t\tif(typeof Class != 'function'){\n\t\t\tconsole.error(\"unknow Class:\"+Class)\n\t\t}\n\t\tpt.constructor = Class\n\t}\n}\nvar htmlns = 'http://www.w3.org/1999/xhtml' ;\n// Node Types\nvar NodeType = {}\nvar ELEMENT_NODE                = NodeType.ELEMENT_NODE                = 1;\nvar ATTRIBUTE_NODE              = NodeType.ATTRIBUTE_NODE              = 2;\nvar TEXT_NODE                   = NodeType.TEXT_NODE                   = 3;\nvar CDATA_SECTION_NODE          = NodeType.CDATA_SECTION_NODE          = 4;\nvar ENTITY_REFERENCE_NODE       = NodeType.ENTITY_REFERENCE_NODE       = 5;\nvar ENTITY_NODE                 = NodeType.ENTITY_NODE                 = 6;\nvar PROCESSING_INSTRUCTION_NODE = NodeType.PROCESSING_INSTRUCTION_NODE = 7;\nvar COMMENT_NODE                = NodeType.COMMENT_NODE                = 8;\nvar DOCUMENT_NODE               = NodeType.DOCUMENT_NODE               = 9;\nvar DOCUMENT_TYPE_NODE          = NodeType.DOCUMENT_TYPE_NODE          = 10;\nvar DOCUMENT_FRAGMENT_NODE      = NodeType.DOCUMENT_FRAGMENT_NODE      = 11;\nvar NOTATION_NODE               = NodeType.NOTATION_NODE               = 12;\n\n// ExceptionCode\nvar ExceptionCode = {}\nvar ExceptionMessage = {};\nvar INDEX_SIZE_ERR              = ExceptionCode.INDEX_SIZE_ERR              = ((ExceptionMessage[1]=\"Index size error\"),1);\nvar DOMSTRING_SIZE_ERR          = ExceptionCode.DOMSTRING_SIZE_ERR          = ((ExceptionMessage[2]=\"DOMString size error\"),2);\nvar HIERARCHY_REQUEST_ERR       = ExceptionCode.HIERARCHY_REQUEST_ERR       = ((ExceptionMessage[3]=\"Hierarchy request error\"),3);\nvar WRONG_DOCUMENT_ERR          = ExceptionCode.WRONG_DOCUMENT_ERR          = ((ExceptionMessage[4]=\"Wrong document\"),4);\nvar INVALID_CHARACTER_ERR       = ExceptionCode.INVALID_CHARACTER_ERR       = ((ExceptionMessage[5]=\"Invalid character\"),5);\nvar NO_DATA_ALLOWED_ERR         = ExceptionCode.NO_DATA_ALLOWED_ERR         = ((ExceptionMessage[6]=\"No data allowed\"),6);\nvar NO_MODIFICATION_ALLOWED_ERR = ExceptionCode.NO_MODIFICATION_ALLOWED_ERR = ((ExceptionMessage[7]=\"No modification allowed\"),7);\nvar NOT_FOUND_ERR               = ExceptionCode.NOT_FOUND_ERR               = ((ExceptionMessage[8]=\"Not found\"),8);\nvar NOT_SUPPORTED_ERR           = ExceptionCode.NOT_SUPPORTED_ERR           = ((ExceptionMessage[9]=\"Not supported\"),9);\nvar INUSE_ATTRIBUTE_ERR         = ExceptionCode.INUSE_ATTRIBUTE_ERR         = ((ExceptionMessage[10]=\"Attribute in use\"),10);\n//level2\nvar INVALID_STATE_ERR        \t= ExceptionCode.INVALID_STATE_ERR        \t= ((ExceptionMessage[11]=\"Invalid state\"),11);\nvar SYNTAX_ERR               \t= ExceptionCode.SYNTAX_ERR               \t= ((ExceptionMessage[12]=\"Syntax error\"),12);\nvar INVALID_MODIFICATION_ERR \t= ExceptionCode.INVALID_MODIFICATION_ERR \t= ((ExceptionMessage[13]=\"Invalid modification\"),13);\nvar NAMESPACE_ERR            \t= ExceptionCode.NAMESPACE_ERR           \t= ((ExceptionMessage[14]=\"Invalid namespace\"),14);\nvar INVALID_ACCESS_ERR       \t= ExceptionCode.INVALID_ACCESS_ERR      \t= ((ExceptionMessage[15]=\"Invalid access\"),15);\n\n/**\n * DOM Level 2\n * Object DOMException\n * @see http://www.w3.org/TR/2000/REC-DOM-Level-2-Core-20001113/ecma-script-binding.html\n * @see http://www.w3.org/TR/REC-DOM-Level-1/ecma-script-language-binding.html\n */\nfunction DOMException(code, message) {\n\tif(message instanceof Error){\n\t\tvar error = message;\n\t}else{\n\t\terror = this;\n\t\tError.call(this, ExceptionMessage[code]);\n\t\tthis.message = ExceptionMessage[code];\n\t\tif(Error.captureStackTrace) Error.captureStackTrace(this, DOMException);\n\t}\n\terror.code = code;\n\tif(message) this.message = this.message + \": \" + message;\n\treturn error;\n};\nDOMException.prototype = Error.prototype;\ncopy(ExceptionCode,DOMException)\n/**\n * @see http://www.w3.org/TR/2000/REC-DOM-Level-2-Core-20001113/core.html#ID-536297177\n * The NodeList interface provides the abstraction of an ordered collection of nodes, without defining or constraining how this collection is implemented. NodeList objects in the DOM are live.\n * The items in the NodeList are accessible via an integral index, starting from 0.\n */\nfunction NodeList() {\n};\nNodeList.prototype = {\n\t/**\n\t * The number of nodes in the list. The range of valid child node indices is 0 to length-1 inclusive.\n\t * @standard level1\n\t */\n\tlength:0, \n\t/**\n\t * Returns the indexth item in the collection. If index is greater than or equal to the number of nodes in the list, this returns null.\n\t * @standard level1\n\t * @param index  unsigned long \n\t *   Index into the collection.\n\t * @return Node\n\t * \tThe node at the indexth position in the NodeList, or null if that is not a valid index. \n\t */\n\titem: function(index) {\n\t\treturn this[index] || null;\n\t},\n\ttoString:function(isHTML,nodeFilter){\n\t\tfor(var buf = [], i = 0;i<this.length;i++){\n\t\t\tserializeToString(this[i],buf,isHTML,nodeFilter);\n\t\t}\n\t\treturn buf.join('');\n\t}\n};\nfunction LiveNodeList(node,refresh){\n\tthis._node = node;\n\tthis._refresh = refresh\n\t_updateLiveList(this);\n}\nfunction _updateLiveList(list){\n\tvar inc = list._node._inc || list._node.ownerDocument._inc;\n\tif(list._inc != inc){\n\t\tvar ls = list._refresh(list._node);\n\t\t//console.log(ls.length)\n\t\t__set__(list,'length',ls.length);\n\t\tcopy(ls,list);\n\t\tlist._inc = inc;\n\t}\n}\nLiveNodeList.prototype.item = function(i){\n\t_updateLiveList(this);\n\treturn this[i];\n}\n\n_extends(LiveNodeList,NodeList);\n/**\n * \n * Objects implementing the NamedNodeMap interface are used to represent collections of nodes that can be accessed by name. Note that NamedNodeMap does not inherit from NodeList; NamedNodeMaps are not maintained in any particular order. Objects contained in an object implementing NamedNodeMap may also be accessed by an ordinal index, but this is simply to allow convenient enumeration of the contents of a NamedNodeMap, and does not imply that the DOM specifies an order to these Nodes.\n * NamedNodeMap objects in the DOM are live.\n * used for attributes or DocumentType entities \n */\nfunction NamedNodeMap() {\n};\n\nfunction _findNodeIndex(list,node){\n\tvar i = list.length;\n\twhile(i--){\n\t\tif(list[i] === node){return i}\n\t}\n}\n\nfunction _addNamedNode(el,list,newAttr,oldAttr){\n\tif(oldAttr){\n\t\tlist[_findNodeIndex(list,oldAttr)] = newAttr;\n\t}else{\n\t\tlist[list.length++] = newAttr;\n\t}\n\tif(el){\n\t\tnewAttr.ownerElement = el;\n\t\tvar doc = el.ownerDocument;\n\t\tif(doc){\n\t\t\toldAttr && _onRemoveAttribute(doc,el,oldAttr);\n\t\t\t_onAddAttribute(doc,el,newAttr);\n\t\t}\n\t}\n}\nfunction _removeNamedNode(el,list,attr){\n\t//console.log('remove attr:'+attr)\n\tvar i = _findNodeIndex(list,attr);\n\tif(i>=0){\n\t\tvar lastIndex = list.length-1\n\t\twhile(i<lastIndex){\n\t\t\tlist[i] = list[++i]\n\t\t}\n\t\tlist.length = lastIndex;\n\t\tif(el){\n\t\t\tvar doc = el.ownerDocument;\n\t\t\tif(doc){\n\t\t\t\t_onRemoveAttribute(doc,el,attr);\n\t\t\t\tattr.ownerElement = null;\n\t\t\t}\n\t\t}\n\t}else{\n\t\tthrow DOMException(NOT_FOUND_ERR,new Error(el.tagName+'@'+attr))\n\t}\n}\nNamedNodeMap.prototype = {\n\tlength:0,\n\titem:NodeList.prototype.item,\n\tgetNamedItem: function(key) {\n//\t\tif(key.indexOf(':')>0 || key == 'xmlns'){\n//\t\t\treturn null;\n//\t\t}\n\t\t//console.log()\n\t\tvar i = this.length;\n\t\twhile(i--){\n\t\t\tvar attr = this[i];\n\t\t\t//console.log(attr.nodeName,key)\n\t\t\tif(attr.nodeName == key){\n\t\t\t\treturn attr;\n\t\t\t}\n\t\t}\n\t},\n\tsetNamedItem: function(attr) {\n\t\tvar el = attr.ownerElement;\n\t\tif(el && el!=this._ownerElement){\n\t\t\tthrow new DOMException(INUSE_ATTRIBUTE_ERR);\n\t\t}\n\t\tvar oldAttr = this.getNamedItem(attr.nodeName);\n\t\t_addNamedNode(this._ownerElement,this,attr,oldAttr);\n\t\treturn oldAttr;\n\t},\n\t/* returns Node */\n\tsetNamedItemNS: function(attr) {// raises: WRONG_DOCUMENT_ERR,NO_MODIFICATION_ALLOWED_ERR,INUSE_ATTRIBUTE_ERR\n\t\tvar el = attr.ownerElement, oldAttr;\n\t\tif(el && el!=this._ownerElement){\n\t\t\tthrow new DOMException(INUSE_ATTRIBUTE_ERR);\n\t\t}\n\t\toldAttr = this.getNamedItemNS(attr.namespaceURI,attr.localName);\n\t\t_addNamedNode(this._ownerElement,this,attr,oldAttr);\n\t\treturn oldAttr;\n\t},\n\n\t/* returns Node */\n\tremoveNamedItem: function(key) {\n\t\tvar attr = this.getNamedItem(key);\n\t\t_removeNamedNode(this._ownerElement,this,attr);\n\t\treturn attr;\n\t\t\n\t\t\n\t},// raises: NOT_FOUND_ERR,NO_MODIFICATION_ALLOWED_ERR\n\t\n\t//for level2\n\tremoveNamedItemNS:function(namespaceURI,localName){\n\t\tvar attr = this.getNamedItemNS(namespaceURI,localName);\n\t\t_removeNamedNode(this._ownerElement,this,attr);\n\t\treturn attr;\n\t},\n\tgetNamedItemNS: function(namespaceURI, localName) {\n\t\tvar i = this.length;\n\t\twhile(i--){\n\t\t\tvar node = this[i];\n\t\t\tif(node.localName == localName && node.namespaceURI == namespaceURI){\n\t\t\t\treturn node;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n};\n/**\n * @see http://www.w3.org/TR/REC-DOM-Level-1/level-one-core.html#ID-102161490\n */\nfunction DOMImplementation(/* Object */ features) {\n\tthis._features = {};\n\tif (features) {\n\t\tfor (var feature in features) {\n\t\t\t this._features = features[feature];\n\t\t}\n\t}\n};\n\nDOMImplementation.prototype = {\n\thasFeature: function(/* string */ feature, /* string */ version) {\n\t\tvar versions = this._features[feature.toLowerCase()];\n\t\tif (versions && (!version || version in versions)) {\n\t\t\treturn true;\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t},\n\t// Introduced in DOM Level 2:\n\tcreateDocument:function(namespaceURI,  qualifiedName, doctype){// raises:INVALID_CHARACTER_ERR,NAMESPACE_ERR,WRONG_DOCUMENT_ERR\n\t\tvar doc = new Document();\n\t\tdoc.implementation = this;\n\t\tdoc.childNodes = new NodeList();\n\t\tdoc.doctype = doctype;\n\t\tif(doctype){\n\t\t\tdoc.appendChild(doctype);\n\t\t}\n\t\tif(qualifiedName){\n\t\t\tvar root = doc.createElementNS(namespaceURI,qualifiedName);\n\t\t\tdoc.appendChild(root);\n\t\t}\n\t\treturn doc;\n\t},\n\t// Introduced in DOM Level 2:\n\tcreateDocumentType:function(qualifiedName, publicId, systemId){// raises:INVALID_CHARACTER_ERR,NAMESPACE_ERR\n\t\tvar node = new DocumentType();\n\t\tnode.name = qualifiedName;\n\t\tnode.nodeName = qualifiedName;\n\t\tnode.publicId = publicId;\n\t\tnode.systemId = systemId;\n\t\t// Introduced in DOM Level 2:\n\t\t//readonly attribute DOMString        internalSubset;\n\t\t\n\t\t//TODO:..\n\t\t//  readonly attribute NamedNodeMap     entities;\n\t\t//  readonly attribute NamedNodeMap     notations;\n\t\treturn node;\n\t}\n};\n\n\n/**\n * @see http://www.w3.org/TR/2000/REC-DOM-Level-2-Core-20001113/core.html#ID-1950641247\n */\n\nfunction Node() {\n};\n\nNode.prototype = {\n\tfirstChild : null,\n\tlastChild : null,\n\tpreviousSibling : null,\n\tnextSibling : null,\n\tattributes : null,\n\tparentNode : null,\n\tchildNodes : null,\n\townerDocument : null,\n\tnodeValue : null,\n\tnamespaceURI : null,\n\tprefix : null,\n\tlocalName : null,\n\t// Modified in DOM Level 2:\n\tinsertBefore:function(newChild, refChild){//raises \n\t\treturn _insertBefore(this,newChild,refChild);\n\t},\n\treplaceChild:function(newChild, oldChild){//raises \n\t\tthis.insertBefore(newChild,oldChild);\n\t\tif(oldChild){\n\t\t\tthis.removeChild(oldChild);\n\t\t}\n\t},\n\tremoveChild:function(oldChild){\n\t\treturn _removeChild(this,oldChild);\n\t},\n\tappendChild:function(newChild){\n\t\treturn this.insertBefore(newChild,null);\n\t},\n\thasChildNodes:function(){\n\t\treturn this.firstChild != null;\n\t},\n\tcloneNode:function(deep){\n\t\treturn cloneNode(this.ownerDocument||this,this,deep);\n\t},\n\t// Modified in DOM Level 2:\n\tnormalize:function(){\n\t\tvar child = this.firstChild;\n\t\twhile(child){\n\t\t\tvar next = child.nextSibling;\n\t\t\tif(next && next.nodeType == TEXT_NODE && child.nodeType == TEXT_NODE){\n\t\t\t\tthis.removeChild(next);\n\t\t\t\tchild.appendData(next.data);\n\t\t\t}else{\n\t\t\t\tchild.normalize();\n\t\t\t\tchild = next;\n\t\t\t}\n\t\t}\n\t},\n  \t// Introduced in DOM Level 2:\n\tisSupported:function(feature, version){\n\t\treturn this.ownerDocument.implementation.hasFeature(feature,version);\n\t},\n    // Introduced in DOM Level 2:\n    hasAttributes:function(){\n    \treturn this.attributes.length>0;\n    },\n    lookupPrefix:function(namespaceURI){\n    \tvar el = this;\n    \twhile(el){\n    \t\tvar map = el._nsMap;\n    \t\t//console.dir(map)\n    \t\tif(map){\n    \t\t\tfor(var n in map){\n    \t\t\t\tif(map[n] == namespaceURI){\n    \t\t\t\t\treturn n;\n    \t\t\t\t}\n    \t\t\t}\n    \t\t}\n    \t\tel = el.nodeType == ATTRIBUTE_NODE?el.ownerDocument : el.parentNode;\n    \t}\n    \treturn null;\n    },\n    // Introduced in DOM Level 3:\n    lookupNamespaceURI:function(prefix){\n    \tvar el = this;\n    \twhile(el){\n    \t\tvar map = el._nsMap;\n    \t\t//console.dir(map)\n    \t\tif(map){\n    \t\t\tif(prefix in map){\n    \t\t\t\treturn map[prefix] ;\n    \t\t\t}\n    \t\t}\n    \t\tel = el.nodeType == ATTRIBUTE_NODE?el.ownerDocument : el.parentNode;\n    \t}\n    \treturn null;\n    },\n    // Introduced in DOM Level 3:\n    isDefaultNamespace:function(namespaceURI){\n    \tvar prefix = this.lookupPrefix(namespaceURI);\n    \treturn prefix == null;\n    }\n};\n\n\nfunction _xmlEncoder(c){\n\treturn c == '<' && '&lt;' ||\n         c == '>' && '&gt;' ||\n         c == '&' && '&amp;' ||\n         c == '\"' && '&quot;' ||\n         '&#'+c.charCodeAt()+';'\n}\n\n\ncopy(NodeType,Node);\ncopy(NodeType,Node.prototype);\n\n/**\n * @param callback return true for continue,false for break\n * @return boolean true: break visit;\n */\nfunction _visitNode(node,callback){\n\tif(callback(node)){\n\t\treturn true;\n\t}\n\tif(node = node.firstChild){\n\t\tdo{\n\t\t\tif(_visitNode(node,callback)){return true}\n        }while(node=node.nextSibling)\n    }\n}\n\n\n\nfunction Document(){\n}\nfunction _onAddAttribute(doc,el,newAttr){\n\tdoc && doc._inc++;\n\tvar ns = newAttr.namespaceURI ;\n\tif(ns == 'http://www.w3.org/2000/xmlns/'){\n\t\t//update namespace\n\t\tel._nsMap[newAttr.prefix?newAttr.localName:''] = newAttr.value\n\t}\n}\nfunction _onRemoveAttribute(doc,el,newAttr,remove){\n\tdoc && doc._inc++;\n\tvar ns = newAttr.namespaceURI ;\n\tif(ns == 'http://www.w3.org/2000/xmlns/'){\n\t\t//update namespace\n\t\tdelete el._nsMap[newAttr.prefix?newAttr.localName:'']\n\t}\n}\nfunction _onUpdateChild(doc,el,newChild){\n\tif(doc && doc._inc){\n\t\tdoc._inc++;\n\t\t//update childNodes\n\t\tvar cs = el.childNodes;\n\t\tif(newChild){\n\t\t\tcs[cs.length++] = newChild;\n\t\t}else{\n\t\t\t//console.log(1)\n\t\t\tvar child = el.firstChild;\n\t\t\tvar i = 0;\n\t\t\twhile(child){\n\t\t\t\tcs[i++] = child;\n\t\t\t\tchild =child.nextSibling;\n\t\t\t}\n\t\t\tcs.length = i;\n\t\t}\n\t}\n}\n\n/**\n * attributes;\n * children;\n * \n * writeable properties:\n * nodeValue,Attr:value,CharacterData:data\n * prefix\n */\nfunction _removeChild(parentNode,child){\n\tvar previous = child.previousSibling;\n\tvar next = child.nextSibling;\n\tif(previous){\n\t\tprevious.nextSibling = next;\n\t}else{\n\t\tparentNode.firstChild = next\n\t}\n\tif(next){\n\t\tnext.previousSibling = previous;\n\t}else{\n\t\tparentNode.lastChild = previous;\n\t}\n\t_onUpdateChild(parentNode.ownerDocument,parentNode);\n\treturn child;\n}\n/**\n * preformance key(refChild == null)\n */\nfunction _insertBefore(parentNode,newChild,nextChild){\n\tvar cp = newChild.parentNode;\n\tif(cp){\n\t\tcp.removeChild(newChild);//remove and update\n\t}\n\tif(newChild.nodeType === DOCUMENT_FRAGMENT_NODE){\n\t\tvar newFirst = newChild.firstChild;\n\t\tif (newFirst == null) {\n\t\t\treturn newChild;\n\t\t}\n\t\tvar newLast = newChild.lastChild;\n\t}else{\n\t\tnewFirst = newLast = newChild;\n\t}\n\tvar pre = nextChild ? nextChild.previousSibling : parentNode.lastChild;\n\n\tnewFirst.previousSibling = pre;\n\tnewLast.nextSibling = nextChild;\n\t\n\t\n\tif(pre){\n\t\tpre.nextSibling = newFirst;\n\t}else{\n\t\tparentNode.firstChild = newFirst;\n\t}\n\tif(nextChild == null){\n\t\tparentNode.lastChild = newLast;\n\t}else{\n\t\tnextChild.previousSibling = newLast;\n\t}\n\tdo{\n\t\tnewFirst.parentNode = parentNode;\n\t}while(newFirst !== newLast && (newFirst= newFirst.nextSibling))\n\t_onUpdateChild(parentNode.ownerDocument||parentNode,parentNode);\n\t//console.log(parentNode.lastChild.nextSibling == null)\n\tif (newChild.nodeType == DOCUMENT_FRAGMENT_NODE) {\n\t\tnewChild.firstChild = newChild.lastChild = null;\n\t}\n\treturn newChild;\n}\nfunction _appendSingleChild(parentNode,newChild){\n\tvar cp = newChild.parentNode;\n\tif(cp){\n\t\tvar pre = parentNode.lastChild;\n\t\tcp.removeChild(newChild);//remove and update\n\t\tvar pre = parentNode.lastChild;\n\t}\n\tvar pre = parentNode.lastChild;\n\tnewChild.parentNode = parentNode;\n\tnewChild.previousSibling = pre;\n\tnewChild.nextSibling = null;\n\tif(pre){\n\t\tpre.nextSibling = newChild;\n\t}else{\n\t\tparentNode.firstChild = newChild;\n\t}\n\tparentNode.lastChild = newChild;\n\t_onUpdateChild(parentNode.ownerDocument,parentNode,newChild);\n\treturn newChild;\n\t//console.log(\"__aa\",parentNode.lastChild.nextSibling == null)\n}\nDocument.prototype = {\n\t//implementation : null,\n\tnodeName :  '#document',\n\tnodeType :  DOCUMENT_NODE,\n\tdoctype :  null,\n\tdocumentElement :  null,\n\t_inc : 1,\n\t\n\tinsertBefore :  function(newChild, refChild){//raises \n\t\tif(newChild.nodeType == DOCUMENT_FRAGMENT_NODE){\n\t\t\tvar child = newChild.firstChild;\n\t\t\twhile(child){\n\t\t\t\tvar next = child.nextSibling;\n\t\t\t\tthis.insertBefore(child,refChild);\n\t\t\t\tchild = next;\n\t\t\t}\n\t\t\treturn newChild;\n\t\t}\n\t\tif(this.documentElement == null && newChild.nodeType == ELEMENT_NODE){\n\t\t\tthis.documentElement = newChild;\n\t\t}\n\t\t\n\t\treturn _insertBefore(this,newChild,refChild),(newChild.ownerDocument = this),newChild;\n\t},\n\tremoveChild :  function(oldChild){\n\t\tif(this.documentElement == oldChild){\n\t\t\tthis.documentElement = null;\n\t\t}\n\t\treturn _removeChild(this,oldChild);\n\t},\n\t// Introduced in DOM Level 2:\n\timportNode : function(importedNode,deep){\n\t\treturn importNode(this,importedNode,deep);\n\t},\n\t// Introduced in DOM Level 2:\n\tgetElementById :\tfunction(id){\n\t\tvar rtv = null;\n\t\t_visitNode(this.documentElement,function(node){\n\t\t\tif(node.nodeType == ELEMENT_NODE){\n\t\t\t\tif(node.getAttribute('id') == id){\n\t\t\t\t\trtv = node;\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\t\treturn rtv;\n\t},\n\t\n\tgetElementsByClassName: function(className) {\n\t\tvar pattern = new RegExp(\"(^|\\\\s)\" + className + \"(\\\\s|$)\");\n\t\treturn new LiveNodeList(this, function(base) {\n\t\t\tvar ls = [];\n\t\t\t_visitNode(base.documentElement, function(node) {\n\t\t\t\tif(node !== base && node.nodeType == ELEMENT_NODE) {\n\t\t\t\t\tif(pattern.test(node.getAttribute('class'))) {\n\t\t\t\t\t\tls.push(node);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn ls;\n\t\t});\n\t},\n\t\n\t//document factory method:\n\tcreateElement :\tfunction(tagName){\n\t\tvar node = new Element();\n\t\tnode.ownerDocument = this;\n\t\tnode.nodeName = tagName;\n\t\tnode.tagName = tagName;\n\t\tnode.childNodes = new NodeList();\n\t\tvar attrs\t= node.attributes = new NamedNodeMap();\n\t\tattrs._ownerElement = node;\n\t\treturn node;\n\t},\n\tcreateDocumentFragment :\tfunction(){\n\t\tvar node = new DocumentFragment();\n\t\tnode.ownerDocument = this;\n\t\tnode.childNodes = new NodeList();\n\t\treturn node;\n\t},\n\tcreateTextNode :\tfunction(data){\n\t\tvar node = new Text();\n\t\tnode.ownerDocument = this;\n\t\tnode.appendData(data)\n\t\treturn node;\n\t},\n\tcreateComment :\tfunction(data){\n\t\tvar node = new Comment();\n\t\tnode.ownerDocument = this;\n\t\tnode.appendData(data)\n\t\treturn node;\n\t},\n\tcreateCDATASection :\tfunction(data){\n\t\tvar node = new CDATASection();\n\t\tnode.ownerDocument = this;\n\t\tnode.appendData(data)\n\t\treturn node;\n\t},\n\tcreateProcessingInstruction :\tfunction(target,data){\n\t\tvar node = new ProcessingInstruction();\n\t\tnode.ownerDocument = this;\n\t\tnode.tagName = node.target = target;\n\t\tnode.nodeValue= node.data = data;\n\t\treturn node;\n\t},\n\tcreateAttribute :\tfunction(name){\n\t\tvar node = new Attr();\n\t\tnode.ownerDocument\t= this;\n\t\tnode.name = name;\n\t\tnode.nodeName\t= name;\n\t\tnode.localName = name;\n\t\tnode.specified = true;\n\t\treturn node;\n\t},\n\tcreateEntityReference :\tfunction(name){\n\t\tvar node = new EntityReference();\n\t\tnode.ownerDocument\t= this;\n\t\tnode.nodeName\t= name;\n\t\treturn node;\n\t},\n\t// Introduced in DOM Level 2:\n\tcreateElementNS :\tfunction(namespaceURI,qualifiedName){\n\t\tvar node = new Element();\n\t\tvar pl = qualifiedName.split(':');\n\t\tvar attrs\t= node.attributes = new NamedNodeMap();\n\t\tnode.childNodes = new NodeList();\n\t\tnode.ownerDocument = this;\n\t\tnode.nodeName = qualifiedName;\n\t\tnode.tagName = qualifiedName;\n\t\tnode.namespaceURI = namespaceURI;\n\t\tif(pl.length == 2){\n\t\t\tnode.prefix = pl[0];\n\t\t\tnode.localName = pl[1];\n\t\t}else{\n\t\t\t//el.prefix = null;\n\t\t\tnode.localName = qualifiedName;\n\t\t}\n\t\tattrs._ownerElement = node;\n\t\treturn node;\n\t},\n\t// Introduced in DOM Level 2:\n\tcreateAttributeNS :\tfunction(namespaceURI,qualifiedName){\n\t\tvar node = new Attr();\n\t\tvar pl = qualifiedName.split(':');\n\t\tnode.ownerDocument = this;\n\t\tnode.nodeName = qualifiedName;\n\t\tnode.name = qualifiedName;\n\t\tnode.namespaceURI = namespaceURI;\n\t\tnode.specified = true;\n\t\tif(pl.length == 2){\n\t\t\tnode.prefix = pl[0];\n\t\t\tnode.localName = pl[1];\n\t\t}else{\n\t\t\t//el.prefix = null;\n\t\t\tnode.localName = qualifiedName;\n\t\t}\n\t\treturn node;\n\t}\n};\n_extends(Document,Node);\n\n\nfunction Element() {\n\tthis._nsMap = {};\n};\nElement.prototype = {\n\tnodeType : ELEMENT_NODE,\n\thasAttribute : function(name){\n\t\treturn this.getAttributeNode(name)!=null;\n\t},\n\tgetAttribute : function(name){\n\t\tvar attr = this.getAttributeNode(name);\n\t\treturn attr && attr.value || '';\n\t},\n\tgetAttributeNode : function(name){\n\t\treturn this.attributes.getNamedItem(name);\n\t},\n\tsetAttribute : function(name, value){\n\t\tvar attr = this.ownerDocument.createAttribute(name);\n\t\tattr.value = attr.nodeValue = \"\" + value;\n\t\tthis.setAttributeNode(attr)\n\t},\n\tremoveAttribute : function(name){\n\t\tvar attr = this.getAttributeNode(name)\n\t\tattr && this.removeAttributeNode(attr);\n\t},\n\t\n\t//four real opeartion method\n\tappendChild:function(newChild){\n\t\tif(newChild.nodeType === DOCUMENT_FRAGMENT_NODE){\n\t\t\treturn this.insertBefore(newChild,null);\n\t\t}else{\n\t\t\treturn _appendSingleChild(this,newChild);\n\t\t}\n\t},\n\tsetAttributeNode : function(newAttr){\n\t\treturn this.attributes.setNamedItem(newAttr);\n\t},\n\tsetAttributeNodeNS : function(newAttr){\n\t\treturn this.attributes.setNamedItemNS(newAttr);\n\t},\n\tremoveAttributeNode : function(oldAttr){\n\t\t//console.log(this == oldAttr.ownerElement)\n\t\treturn this.attributes.removeNamedItem(oldAttr.nodeName);\n\t},\n\t//get real attribute name,and remove it by removeAttributeNode\n\tremoveAttributeNS : function(namespaceURI, localName){\n\t\tvar old = this.getAttributeNodeNS(namespaceURI, localName);\n\t\told && this.removeAttributeNode(old);\n\t},\n\t\n\thasAttributeNS : function(namespaceURI, localName){\n\t\treturn this.getAttributeNodeNS(namespaceURI, localName)!=null;\n\t},\n\tgetAttributeNS : function(namespaceURI, localName){\n\t\tvar attr = this.getAttributeNodeNS(namespaceURI, localName);\n\t\treturn attr && attr.value || '';\n\t},\n\tsetAttributeNS : function(namespaceURI, qualifiedName, value){\n\t\tvar attr = this.ownerDocument.createAttributeNS(namespaceURI, qualifiedName);\n\t\tattr.value = attr.nodeValue = \"\" + value;\n\t\tthis.setAttributeNode(attr)\n\t},\n\tgetAttributeNodeNS : function(namespaceURI, localName){\n\t\treturn this.attributes.getNamedItemNS(namespaceURI, localName);\n\t},\n\t\n\tgetElementsByTagName : function(tagName){\n\t\treturn new LiveNodeList(this,function(base){\n\t\t\tvar ls = [];\n\t\t\t_visitNode(base,function(node){\n\t\t\t\tif(node !== base && node.nodeType == ELEMENT_NODE && (tagName === '*' || node.tagName == tagName)){\n\t\t\t\t\tls.push(node);\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn ls;\n\t\t});\n\t},\n\tgetElementsByTagNameNS : function(namespaceURI, localName){\n\t\treturn new LiveNodeList(this,function(base){\n\t\t\tvar ls = [];\n\t\t\t_visitNode(base,function(node){\n\t\t\t\tif(node !== base && node.nodeType === ELEMENT_NODE && (namespaceURI === '*' || node.namespaceURI === namespaceURI) && (localName === '*' || node.localName == localName)){\n\t\t\t\t\tls.push(node);\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn ls;\n\t\t\t\n\t\t});\n\t}\n};\nDocument.prototype.getElementsByTagName = Element.prototype.getElementsByTagName;\nDocument.prototype.getElementsByTagNameNS = Element.prototype.getElementsByTagNameNS;\n\n\n_extends(Element,Node);\nfunction Attr() {\n};\nAttr.prototype.nodeType = ATTRIBUTE_NODE;\n_extends(Attr,Node);\n\n\nfunction CharacterData() {\n};\nCharacterData.prototype = {\n\tdata : '',\n\tsubstringData : function(offset, count) {\n\t\treturn this.data.substring(offset, offset+count);\n\t},\n\tappendData: function(text) {\n\t\ttext = this.data+text;\n\t\tthis.nodeValue = this.data = text;\n\t\tthis.length = text.length;\n\t},\n\tinsertData: function(offset,text) {\n\t\tthis.replaceData(offset,0,text);\n\t\n\t},\n\tappendChild:function(newChild){\n\t\tthrow new Error(ExceptionMessage[HIERARCHY_REQUEST_ERR])\n\t},\n\tdeleteData: function(offset, count) {\n\t\tthis.replaceData(offset,count,\"\");\n\t},\n\treplaceData: function(offset, count, text) {\n\t\tvar start = this.data.substring(0,offset);\n\t\tvar end = this.data.substring(offset+count);\n\t\ttext = start + text + end;\n\t\tthis.nodeValue = this.data = text;\n\t\tthis.length = text.length;\n\t}\n}\n_extends(CharacterData,Node);\nfunction Text() {\n};\nText.prototype = {\n\tnodeName : \"#text\",\n\tnodeType : TEXT_NODE,\n\tsplitText : function(offset) {\n\t\tvar text = this.data;\n\t\tvar newText = text.substring(offset);\n\t\ttext = text.substring(0, offset);\n\t\tthis.data = this.nodeValue = text;\n\t\tthis.length = text.length;\n\t\tvar newNode = this.ownerDocument.createTextNode(newText);\n\t\tif(this.parentNode){\n\t\t\tthis.parentNode.insertBefore(newNode, this.nextSibling);\n\t\t}\n\t\treturn newNode;\n\t}\n}\n_extends(Text,CharacterData);\nfunction Comment() {\n};\nComment.prototype = {\n\tnodeName : \"#comment\",\n\tnodeType : COMMENT_NODE\n}\n_extends(Comment,CharacterData);\n\nfunction CDATASection() {\n};\nCDATASection.prototype = {\n\tnodeName : \"#cdata-section\",\n\tnodeType : CDATA_SECTION_NODE\n}\n_extends(CDATASection,CharacterData);\n\n\nfunction DocumentType() {\n};\nDocumentType.prototype.nodeType = DOCUMENT_TYPE_NODE;\n_extends(DocumentType,Node);\n\nfunction Notation() {\n};\nNotation.prototype.nodeType = NOTATION_NODE;\n_extends(Notation,Node);\n\nfunction Entity() {\n};\nEntity.prototype.nodeType = ENTITY_NODE;\n_extends(Entity,Node);\n\nfunction EntityReference() {\n};\nEntityReference.prototype.nodeType = ENTITY_REFERENCE_NODE;\n_extends(EntityReference,Node);\n\nfunction DocumentFragment() {\n};\nDocumentFragment.prototype.nodeName =\t\"#document-fragment\";\nDocumentFragment.prototype.nodeType =\tDOCUMENT_FRAGMENT_NODE;\n_extends(DocumentFragment,Node);\n\n\nfunction ProcessingInstruction() {\n}\nProcessingInstruction.prototype.nodeType = PROCESSING_INSTRUCTION_NODE;\n_extends(ProcessingInstruction,Node);\nfunction XMLSerializer(){}\nXMLSerializer.prototype.serializeToString = function(node,isHtml,nodeFilter){\n\treturn nodeSerializeToString.call(node,isHtml,nodeFilter);\n}\nNode.prototype.toString = nodeSerializeToString;\nfunction nodeSerializeToString(isHtml,nodeFilter){\n\tvar buf = [];\n\tvar refNode = this.nodeType == 9 && this.documentElement || this;\n\tvar prefix = refNode.prefix;\n\tvar uri = refNode.namespaceURI;\n\t\n\tif(uri && prefix == null){\n\t\t//console.log(prefix)\n\t\tvar prefix = refNode.lookupPrefix(uri);\n\t\tif(prefix == null){\n\t\t\t//isHTML = true;\n\t\t\tvar visibleNamespaces=[\n\t\t\t{namespace:uri,prefix:null}\n\t\t\t//{namespace:uri,prefix:''}\n\t\t\t]\n\t\t}\n\t}\n\tserializeToString(this,buf,isHtml,nodeFilter,visibleNamespaces);\n\t//console.log('###',this.nodeType,uri,prefix,buf.join(''))\n\treturn buf.join('');\n}\nfunction needNamespaceDefine(node,isHTML, visibleNamespaces) {\n\tvar prefix = node.prefix||'';\n\tvar uri = node.namespaceURI;\n\tif (!prefix && !uri){\n\t\treturn false;\n\t}\n\tif (prefix === \"xml\" && uri === \"http://www.w3.org/XML/1998/namespace\" \n\t\t|| uri == 'http://www.w3.org/2000/xmlns/'){\n\t\treturn false;\n\t}\n\t\n\tvar i = visibleNamespaces.length \n\t//console.log('@@@@',node.tagName,prefix,uri,visibleNamespaces)\n\twhile (i--) {\n\t\tvar ns = visibleNamespaces[i];\n\t\t// get namespace prefix\n\t\t//console.log(node.nodeType,node.tagName,ns.prefix,prefix)\n\t\tif (ns.prefix == prefix){\n\t\t\treturn ns.namespace != uri;\n\t\t}\n\t}\n\t//console.log(isHTML,uri,prefix=='')\n\t//if(isHTML && prefix ==null && uri == 'http://www.w3.org/1999/xhtml'){\n\t//\treturn false;\n\t//}\n\t//node.flag = '11111'\n\t//console.error(3,true,node.flag,node.prefix,node.namespaceURI)\n\treturn true;\n}\nfunction serializeToString(node,buf,isHTML,nodeFilter,visibleNamespaces){\n\tif(nodeFilter){\n\t\tnode = nodeFilter(node);\n\t\tif(node){\n\t\t\tif(typeof node == 'string'){\n\t\t\t\tbuf.push(node);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}else{\n\t\t\treturn;\n\t\t}\n\t\t//buf.sort.apply(attrs, attributeSorter);\n\t}\n\tswitch(node.nodeType){\n\tcase ELEMENT_NODE:\n\t\tif (!visibleNamespaces) visibleNamespaces = [];\n\t\tvar startVisibleNamespaces = visibleNamespaces.length;\n\t\tvar attrs = node.attributes;\n\t\tvar len = attrs.length;\n\t\tvar child = node.firstChild;\n\t\tvar nodeName = node.tagName;\n\t\t\n\t\tisHTML =  (htmlns === node.namespaceURI) ||isHTML \n\t\tbuf.push('<',nodeName);\n\t\t\n\t\t\n\t\t\n\t\tfor(var i=0;i<len;i++){\n\t\t\t// add namespaces for attributes\n\t\t\tvar attr = attrs.item(i);\n\t\t\tif (attr.prefix == 'xmlns') {\n\t\t\t\tvisibleNamespaces.push({ prefix: attr.localName, namespace: attr.value });\n\t\t\t}else if(attr.nodeName == 'xmlns'){\n\t\t\t\tvisibleNamespaces.push({ prefix: '', namespace: attr.value });\n\t\t\t}\n\t\t}\n\t\tfor(var i=0;i<len;i++){\n\t\t\tvar attr = attrs.item(i);\n\t\t\tif (needNamespaceDefine(attr,isHTML, visibleNamespaces)) {\n\t\t\t\tvar prefix = attr.prefix||'';\n\t\t\t\tvar uri = attr.namespaceURI;\n\t\t\t\tvar ns = prefix ? ' xmlns:' + prefix : \" xmlns\";\n\t\t\t\tbuf.push(ns, '=\"' , uri , '\"');\n\t\t\t\tvisibleNamespaces.push({ prefix: prefix, namespace:uri });\n\t\t\t}\n\t\t\tserializeToString(attr,buf,isHTML,nodeFilter,visibleNamespaces);\n\t\t}\n\t\t// add namespace for current node\t\t\n\t\tif (needNamespaceDefine(node,isHTML, visibleNamespaces)) {\n\t\t\tvar prefix = node.prefix||'';\n\t\t\tvar uri = node.namespaceURI;\n\t\t\tif (uri) {\n\t\t\t\t// Avoid empty namespace value like xmlns:ds=\"\"\n\t\t\t\t// Empty namespace URL will we produce an invalid XML document\n\t\t\t\tvar ns = prefix ? ' xmlns:' + prefix : \" xmlns\";\n\t\t\t\tbuf.push(ns, '=\"' , uri , '\"');\n\t\t\t\tvisibleNamespaces.push({ prefix: prefix, namespace:uri });\n\t\t\t}\n\t\t}\n\t\t\n\t\tif(child || isHTML && !/^(?:meta|link|img|br|hr|input)$/i.test(nodeName)){\n\t\t\tbuf.push('>');\n\t\t\t//if is cdata child node\n\t\t\tif(isHTML && /^script$/i.test(nodeName)){\n\t\t\t\twhile(child){\n\t\t\t\t\tif(child.data){\n\t\t\t\t\t\tbuf.push(child.data);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tserializeToString(child,buf,isHTML,nodeFilter,visibleNamespaces);\n\t\t\t\t\t}\n\t\t\t\t\tchild = child.nextSibling;\n\t\t\t\t}\n\t\t\t}else\n\t\t\t{\n\t\t\t\twhile(child){\n\t\t\t\t\tserializeToString(child,buf,isHTML,nodeFilter,visibleNamespaces);\n\t\t\t\t\tchild = child.nextSibling;\n\t\t\t\t}\n\t\t\t}\n\t\t\tbuf.push('</',nodeName,'>');\n\t\t}else{\n\t\t\tbuf.push('/>');\n\t\t}\n\t\t// remove added visible namespaces\n\t\t//visibleNamespaces.length = startVisibleNamespaces;\n\t\treturn;\n\tcase DOCUMENT_NODE:\n\tcase DOCUMENT_FRAGMENT_NODE:\n\t\tvar child = node.firstChild;\n\t\twhile(child){\n\t\t\tserializeToString(child,buf,isHTML,nodeFilter,visibleNamespaces);\n\t\t\tchild = child.nextSibling;\n\t\t}\n\t\treturn;\n\tcase ATTRIBUTE_NODE:\n\t\t/**\n\t\t * Well-formedness constraint: No < in Attribute Values\n\t\t * The replacement text of any entity referred to directly or indirectly in an attribute value must not contain a <.\n\t\t * @see https://www.w3.org/TR/xml/#CleanAttrVals\n\t\t * @see https://www.w3.org/TR/xml/#NT-AttValue\n\t\t */\n\t\treturn buf.push(' ', node.name, '=\"', node.value.replace(/[<&\"]/g,_xmlEncoder), '\"');\n\tcase TEXT_NODE:\n\t\t/**\n\t\t * The ampersand character (&) and the left angle bracket (<) must not appear in their literal form,\n\t\t * except when used as markup delimiters, or within a comment, a processing instruction, or a CDATA section.\n\t\t * If they are needed elsewhere, they must be escaped using either numeric character references or the strings\n\t\t * `&amp;` and `&lt;` respectively.\n\t\t * The right angle bracket (>) may be represented using the string \" &gt; \", and must, for compatibility,\n\t\t * be escaped using either `&gt;` or a character reference when it appears in the string `]]>` in content,\n\t\t * when that string is not marking the end of a CDATA section.\n\t\t *\n\t\t * In the content of elements, character data is any string of characters\n\t\t * which does not contain the start-delimiter of any markup\n\t\t * and does not include the CDATA-section-close delimiter, `]]>`.\n\t\t *\n\t\t * @see https://www.w3.org/TR/xml/#NT-CharData\n\t\t */\n\t\treturn buf.push(node.data\n\t\t\t.replace(/[<&]/g,_xmlEncoder)\n\t\t\t.replace(/]]>/g, ']]&gt;')\n\t\t);\n\tcase CDATA_SECTION_NODE:\n\t\treturn buf.push( '<![CDATA[',node.data,']]>');\n\tcase COMMENT_NODE:\n\t\treturn buf.push( \"<!--\",node.data,\"-->\");\n\tcase DOCUMENT_TYPE_NODE:\n\t\tvar pubid = node.publicId;\n\t\tvar sysid = node.systemId;\n\t\tbuf.push('<!DOCTYPE ',node.name);\n\t\tif(pubid){\n\t\t\tbuf.push(' PUBLIC ', pubid);\n\t\t\tif (sysid && sysid!='.') {\n\t\t\t\tbuf.push(' ', sysid);\n\t\t\t}\n\t\t\tbuf.push('>');\n\t\t}else if(sysid && sysid!='.'){\n\t\t\tbuf.push(' SYSTEM ', sysid, '>');\n\t\t}else{\n\t\t\tvar sub = node.internalSubset;\n\t\t\tif(sub){\n\t\t\t\tbuf.push(\" [\",sub,\"]\");\n\t\t\t}\n\t\t\tbuf.push(\">\");\n\t\t}\n\t\treturn;\n\tcase PROCESSING_INSTRUCTION_NODE:\n\t\treturn buf.push( \"<?\",node.target,\" \",node.data,\"?>\");\n\tcase ENTITY_REFERENCE_NODE:\n\t\treturn buf.push( '&',node.nodeName,';');\n\t//case ENTITY_NODE:\n\t//case NOTATION_NODE:\n\tdefault:\n\t\tbuf.push('??',node.nodeName);\n\t}\n}\nfunction importNode(doc,node,deep){\n\tvar node2;\n\tswitch (node.nodeType) {\n\tcase ELEMENT_NODE:\n\t\tnode2 = node.cloneNode(false);\n\t\tnode2.ownerDocument = doc;\n\t\t//var attrs = node2.attributes;\n\t\t//var len = attrs.length;\n\t\t//for(var i=0;i<len;i++){\n\t\t\t//node2.setAttributeNodeNS(importNode(doc,attrs.item(i),deep));\n\t\t//}\n\tcase DOCUMENT_FRAGMENT_NODE:\n\t\tbreak;\n\tcase ATTRIBUTE_NODE:\n\t\tdeep = true;\n\t\tbreak;\n\t//case ENTITY_REFERENCE_NODE:\n\t//case PROCESSING_INSTRUCTION_NODE:\n\t////case TEXT_NODE:\n\t//case CDATA_SECTION_NODE:\n\t//case COMMENT_NODE:\n\t//\tdeep = false;\n\t//\tbreak;\n\t//case DOCUMENT_NODE:\n\t//case DOCUMENT_TYPE_NODE:\n\t//cannot be imported.\n\t//case ENTITY_NODE:\n\t//case NOTATION_NODE：\n\t//can not hit in level3\n\t//default:throw e;\n\t}\n\tif(!node2){\n\t\tnode2 = node.cloneNode(false);//false\n\t}\n\tnode2.ownerDocument = doc;\n\tnode2.parentNode = null;\n\tif(deep){\n\t\tvar child = node.firstChild;\n\t\twhile(child){\n\t\t\tnode2.appendChild(importNode(doc,child,deep));\n\t\t\tchild = child.nextSibling;\n\t\t}\n\t}\n\treturn node2;\n}\n//\n//var _relationMap = {firstChild:1,lastChild:1,previousSibling:1,nextSibling:1,\n//\t\t\t\t\tattributes:1,childNodes:1,parentNode:1,documentElement:1,doctype,};\nfunction cloneNode(doc,node,deep){\n\tvar node2 = new node.constructor();\n\tfor(var n in node){\n\t\tvar v = node[n];\n\t\tif(typeof v != 'object' ){\n\t\t\tif(v != node2[n]){\n\t\t\t\tnode2[n] = v;\n\t\t\t}\n\t\t}\n\t}\n\tif(node.childNodes){\n\t\tnode2.childNodes = new NodeList();\n\t}\n\tnode2.ownerDocument = doc;\n\tswitch (node2.nodeType) {\n\tcase ELEMENT_NODE:\n\t\tvar attrs\t= node.attributes;\n\t\tvar attrs2\t= node2.attributes = new NamedNodeMap();\n\t\tvar len = attrs.length\n\t\tattrs2._ownerElement = node2;\n\t\tfor(var i=0;i<len;i++){\n\t\t\tnode2.setAttributeNode(cloneNode(doc,attrs.item(i),true));\n\t\t}\n\t\tbreak;;\n\tcase ATTRIBUTE_NODE:\n\t\tdeep = true;\n\t}\n\tif(deep){\n\t\tvar child = node.firstChild;\n\t\twhile(child){\n\t\t\tnode2.appendChild(cloneNode(doc,child,deep));\n\t\t\tchild = child.nextSibling;\n\t\t}\n\t}\n\treturn node2;\n}\n\nfunction __set__(object,key,value){\n\tobject[key] = value\n}\n//do dynamic\ntry{\n\tif(Object.defineProperty){\n\t\tObject.defineProperty(LiveNodeList.prototype,'length',{\n\t\t\tget:function(){\n\t\t\t\t_updateLiveList(this);\n\t\t\t\treturn this.$$length;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(Node.prototype,'textContent',{\n\t\t\tget:function(){\n\t\t\t\treturn getTextContent(this);\n\t\t\t},\n\t\t\tset:function(data){\n\t\t\t\tswitch(this.nodeType){\n\t\t\t\tcase ELEMENT_NODE:\n\t\t\t\tcase DOCUMENT_FRAGMENT_NODE:\n\t\t\t\t\twhile(this.firstChild){\n\t\t\t\t\t\tthis.removeChild(this.firstChild);\n\t\t\t\t\t}\n\t\t\t\t\tif(data || String(data)){\n\t\t\t\t\t\tthis.appendChild(this.ownerDocument.createTextNode(data));\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\t//TODO:\n\t\t\t\t\tthis.data = data;\n\t\t\t\t\tthis.value = data;\n\t\t\t\t\tthis.nodeValue = data;\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\t\t\n\t\tfunction getTextContent(node){\n\t\t\tswitch(node.nodeType){\n\t\t\tcase ELEMENT_NODE:\n\t\t\tcase DOCUMENT_FRAGMENT_NODE:\n\t\t\t\tvar buf = [];\n\t\t\t\tnode = node.firstChild;\n\t\t\t\twhile(node){\n\t\t\t\t\tif(node.nodeType!==7 && node.nodeType !==8){\n\t\t\t\t\t\tbuf.push(getTextContent(node));\n\t\t\t\t\t}\n\t\t\t\t\tnode = node.nextSibling;\n\t\t\t\t}\n\t\t\t\treturn buf.join('');\n\t\t\tdefault:\n\t\t\t\treturn node.nodeValue;\n\t\t\t}\n\t\t}\n\t\t__set__ = function(object,key,value){\n\t\t\t//console.log(value)\n\t\t\tobject['$$'+key] = value\n\t\t}\n\t}\n}catch(e){//ie8\n}\n\n//if(typeof require == 'function'){\n\texports.Node = Node;\n\texports.DOMException = DOMException;\n\texports.DOMImplementation = DOMImplementation;\n\texports.XMLSerializer = XMLSerializer;\n//}\n","function DOMParser(options){\n\tthis.options = options ||{locator:{}};\n}\n\nDOMParser.prototype.parseFromString = function(source,mimeType){\n\tvar options = this.options;\n\tvar sax =  new XMLReader();\n\tvar domBuilder = options.domBuilder || new DOMHandler();//contentHandler and LexicalHandler\n\tvar errorHandler = options.errorHandler;\n\tvar locator = options.locator;\n\tvar defaultNSMap = options.xmlns||{};\n\tvar isHTML = /\\/x?html?$/.test(mimeType);//mimeType.toLowerCase().indexOf('html') > -1;\n  \tvar entityMap = isHTML?htmlEntity.entityMap:{'lt':'<','gt':'>','amp':'&','quot':'\"','apos':\"'\"};\n\tif(locator){\n\t\tdomBuilder.setDocumentLocator(locator)\n\t}\n\n\tsax.errorHandler = buildErrorHandler(errorHandler,domBuilder,locator);\n\tsax.domBuilder = options.domBuilder || domBuilder;\n\tif(isHTML){\n\t\tdefaultNSMap['']= 'http://www.w3.org/1999/xhtml';\n\t}\n\tdefaultNSMap.xml = defaultNSMap.xml || 'http://www.w3.org/XML/1998/namespace';\n\tif(source && typeof source === 'string'){\n\t\tsax.parse(source,defaultNSMap,entityMap);\n\t}else{\n\t\tsax.errorHandler.error(\"invalid doc source\");\n\t}\n\treturn domBuilder.doc;\n}\nfunction buildErrorHandler(errorImpl,domBuilder,locator){\n\tif(!errorImpl){\n\t\tif(domBuilder instanceof DOMHandler){\n\t\t\treturn domBuilder;\n\t\t}\n\t\terrorImpl = domBuilder ;\n\t}\n\tvar errorHandler = {}\n\tvar isCallback = errorImpl instanceof Function;\n\tlocator = locator||{}\n\tfunction build(key){\n\t\tvar fn = errorImpl[key];\n\t\tif(!fn && isCallback){\n\t\t\tfn = errorImpl.length == 2?function(msg){errorImpl(key,msg)}:errorImpl;\n\t\t}\n\t\terrorHandler[key] = fn && function(msg){\n\t\t\tfn('[xmldom '+key+']\\t'+msg+_locator(locator));\n\t\t}||function(){};\n\t}\n\tbuild('warning');\n\tbuild('error');\n\tbuild('fatalError');\n\treturn errorHandler;\n}\n\n//console.log('#\\n\\n\\n\\n\\n\\n\\n####')\n/**\n * +ContentHandler+ErrorHandler\n * +LexicalHandler+EntityResolver2\n * -DeclHandler-DTDHandler\n *\n * DefaultHandler:EntityResolver, DTDHandler, ContentHandler, ErrorHandler\n * DefaultHandler2:DefaultHandler,LexicalHandler, DeclHandler, EntityResolver2\n * @link http://www.saxproject.org/apidoc/org/xml/sax/helpers/DefaultHandler.html\n */\nfunction DOMHandler() {\n    this.cdata = false;\n}\nfunction position(locator,node){\n\tnode.lineNumber = locator.lineNumber;\n\tnode.columnNumber = locator.columnNumber;\n}\n/**\n * @see org.xml.sax.ContentHandler#startDocument\n * @link http://www.saxproject.org/apidoc/org/xml/sax/ContentHandler.html\n */\nDOMHandler.prototype = {\n\tstartDocument : function() {\n    \tthis.doc = new DOMImplementation().createDocument(null, null, null);\n    \tif (this.locator) {\n        \tthis.doc.documentURI = this.locator.systemId;\n    \t}\n\t},\n\tstartElement:function(namespaceURI, localName, qName, attrs) {\n\t\tvar doc = this.doc;\n\t    var el = doc.createElementNS(namespaceURI, qName||localName);\n\t    var len = attrs.length;\n\t    appendElement(this, el);\n\t    this.currentElement = el;\n\n\t\tthis.locator && position(this.locator,el)\n\t    for (var i = 0 ; i < len; i++) {\n\t        var namespaceURI = attrs.getURI(i);\n\t        var value = attrs.getValue(i);\n\t        var qName = attrs.getQName(i);\n\t\t\tvar attr = doc.createAttributeNS(namespaceURI, qName);\n\t\t\tthis.locator &&position(attrs.getLocator(i),attr);\n\t\t\tattr.value = attr.nodeValue = value;\n\t\t\tel.setAttributeNode(attr)\n\t    }\n\t},\n\tendElement:function(namespaceURI, localName, qName) {\n\t\tvar current = this.currentElement\n\t\tvar tagName = current.tagName;\n\t\tthis.currentElement = current.parentNode;\n\t},\n\tstartPrefixMapping:function(prefix, uri) {\n\t},\n\tendPrefixMapping:function(prefix) {\n\t},\n\tprocessingInstruction:function(target, data) {\n\t    var ins = this.doc.createProcessingInstruction(target, data);\n\t    this.locator && position(this.locator,ins)\n\t    appendElement(this, ins);\n\t},\n\tignorableWhitespace:function(ch, start, length) {\n\t},\n\tcharacters:function(chars, start, length) {\n\t\tchars = _toString.apply(this,arguments)\n\t\t//console.log(chars)\n\t\tif(chars){\n\t\t\tif (this.cdata) {\n\t\t\t\tvar charNode = this.doc.createCDATASection(chars);\n\t\t\t} else {\n\t\t\t\tvar charNode = this.doc.createTextNode(chars);\n\t\t\t}\n\t\t\tif(this.currentElement){\n\t\t\t\tthis.currentElement.appendChild(charNode);\n\t\t\t}else if(/^\\s*$/.test(chars)){\n\t\t\t\tthis.doc.appendChild(charNode);\n\t\t\t\t//process xml\n\t\t\t}\n\t\t\tthis.locator && position(this.locator,charNode)\n\t\t}\n\t},\n\tskippedEntity:function(name) {\n\t},\n\tendDocument:function() {\n\t\tthis.doc.normalize();\n\t},\n\tsetDocumentLocator:function (locator) {\n\t    if(this.locator = locator){// && !('lineNumber' in locator)){\n\t    \tlocator.lineNumber = 0;\n\t    }\n\t},\n\t//LexicalHandler\n\tcomment:function(chars, start, length) {\n\t\tchars = _toString.apply(this,arguments)\n\t    var comm = this.doc.createComment(chars);\n\t    this.locator && position(this.locator,comm)\n\t    appendElement(this, comm);\n\t},\n\n\tstartCDATA:function() {\n\t    //used in characters() methods\n\t    this.cdata = true;\n\t},\n\tendCDATA:function() {\n\t    this.cdata = false;\n\t},\n\n\tstartDTD:function(name, publicId, systemId) {\n\t\tvar impl = this.doc.implementation;\n\t    if (impl && impl.createDocumentType) {\n\t        var dt = impl.createDocumentType(name, publicId, systemId);\n\t        this.locator && position(this.locator,dt)\n\t        appendElement(this, dt);\n\t    }\n\t},\n\t/**\n\t * @see org.xml.sax.ErrorHandler\n\t * @link http://www.saxproject.org/apidoc/org/xml/sax/ErrorHandler.html\n\t */\n\twarning:function(error) {\n\t\tconsole.warn('[xmldom warning]\\t'+error,_locator(this.locator));\n\t},\n\terror:function(error) {\n\t\tconsole.error('[xmldom error]\\t'+error,_locator(this.locator));\n\t},\n\tfatalError:function(error) {\n\t\tthrow new ParseError(error, this.locator);\n\t}\n}\nfunction _locator(l){\n\tif(l){\n\t\treturn '\\n@'+(l.systemId ||'')+'#[line:'+l.lineNumber+',col:'+l.columnNumber+']'\n\t}\n}\nfunction _toString(chars,start,length){\n\tif(typeof chars == 'string'){\n\t\treturn chars.substr(start,length)\n\t}else{//java sax connect width xmldom on rhino(what about: \"? && !(chars instanceof String)\")\n\t\tif(chars.length >= start+length || start){\n\t\t\treturn new java.lang.String(chars,start,length)+'';\n\t\t}\n\t\treturn chars;\n\t}\n}\n\n/*\n * @link http://www.saxproject.org/apidoc/org/xml/sax/ext/LexicalHandler.html\n * used method of org.xml.sax.ext.LexicalHandler:\n *  #comment(chars, start, length)\n *  #startCDATA()\n *  #endCDATA()\n *  #startDTD(name, publicId, systemId)\n *\n *\n * IGNORED method of org.xml.sax.ext.LexicalHandler:\n *  #endDTD()\n *  #startEntity(name)\n *  #endEntity(name)\n *\n *\n * @link http://www.saxproject.org/apidoc/org/xml/sax/ext/DeclHandler.html\n * IGNORED method of org.xml.sax.ext.DeclHandler\n * \t#attributeDecl(eName, aName, type, mode, value)\n *  #elementDecl(name, model)\n *  #externalEntityDecl(name, publicId, systemId)\n *  #internalEntityDecl(name, value)\n * @link http://www.saxproject.org/apidoc/org/xml/sax/ext/EntityResolver2.html\n * IGNORED method of org.xml.sax.EntityResolver2\n *  #resolveEntity(String name,String publicId,String baseURI,String systemId)\n *  #resolveEntity(publicId, systemId)\n *  #getExternalSubset(name, baseURI)\n * @link http://www.saxproject.org/apidoc/org/xml/sax/DTDHandler.html\n * IGNORED method of org.xml.sax.DTDHandler\n *  #notationDecl(name, publicId, systemId) {};\n *  #unparsedEntityDecl(name, publicId, systemId, notationName) {};\n */\n\"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl\".replace(/\\w+/g,function(key){\n\tDOMHandler.prototype[key] = function(){return null}\n})\n\n/* Private static helpers treated below as private instance methods, so don't need to add these to the public API; we might use a Relator to also get rid of non-standard public properties */\nfunction appendElement (hander,node) {\n    if (!hander.currentElement) {\n        hander.doc.appendChild(node);\n    } else {\n        hander.currentElement.appendChild(node);\n    }\n}//appendChild and setAttributeNS are preformance key\n\n//if(typeof require == 'function'){\nvar htmlEntity = require('./entities');\nvar sax = require('./sax');\nvar XMLReader = sax.XMLReader;\nvar ParseError = sax.ParseError;\nvar DOMImplementation = exports.DOMImplementation = require('./dom').DOMImplementation;\nexports.XMLSerializer = require('./dom').XMLSerializer ;\nexports.DOMParser = DOMParser;\nexports.__DOMHandler = DOMHandler;\n//}\n","// index.js\nconst converter = require(\"@tmcw/togeojson\");\nconst DOMParser = require(\"xmldom\").DOMParser;\n\n// for node.js 用的\nconst fs = require(\"fs\");\n// 找到檔案路徑解析\n// const parsedKML = new DOMParser().parseFromString(fs.readFileSync(\"<PATH_TO_KML>\", \"utf8\"));\n// const parsedKML = new DOMParser().parseFromString(fs.readFileSync(\"/Users/lui/Desktop/082044.kml\", \"utf8\"));\n\n// 編譯為 json\n// const geojson = converter.kml(parsedKML);\n\n// 寫入成檔案\n// fs.writeFile('/Users/lui/Desktop/082044.json', JSON.stringify(geojson),function (error) {\n//   console.log(error)\n//   console.log('文件寫入成功')\n// })\n\n// 下載函式\nconst downloadJson = (dataStr, fileName) => {\n  if (dataStr && fileName) {\n    // 建立 DOM\n    const downloadDOM = document.createElement('a');\n  \n    // 設定連結與下載屬性\n    downloadDOM.setAttribute(\"href\", dataStr);\n    downloadDOM.setAttribute(\"download\", fileName);\n  \n    // 掛到 body 上並觸發點擊，然後再移除\n    document.body.appendChild(downloadDOM);\n    downloadDOM.click();\n    document.body.removeChild(downloadDOM);\n  }\n}\n\n\n// 轉換函式\nconst convertKml2JSON = (file) => {\n  if (file) {\n    // 註冊檔案讀取元件\n    const reader = new FileReader();\n    let dataStr;\n    reader.onload = (e) => {\n      // 解析字串\n      const xmlStr = e.target.result;\n      const parsedKML = new DOMParser().parseFromString(xmlStr, \"text/xml\");\n\n      // 轉換 kml 成 json 物件再轉 data文字\n      const geojson = converter.kml(parsedKML);\n      dataStr = \"data:text/json;charset=utf-8,\" + encodeURIComponent(JSON.stringify(geojson));\n\n      // 執行下載函式下載 json檔\n      const fileName = file.name.replace('kml', 'json');\n      downloadJson(dataStr, fileName)\n    }\n    // 以文字讀取\n    reader.readAsText(file);\n  }\n}\n\n// 監聽\ndocument.addEventListener('DOMContentLoaded', () => {\n\n  // DOM\n  const fileUploadInput = document.getElementById('fileUpload');\n  const convertBtn = document.getElementById('convertBtn');\n\n  // 點擊後觸發\n  convertBtn.addEventListener('click', () => {\n    const file = fileUploadInput.files[0];\n    convertKml2JSON(file);\n  })\n})\n","var OVERLAY_ID = '__parcel__error__overlay__';\n\nvar OldModule = module.bundle.Module;\n\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData,\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n\n  module.bundle.hotData = null;\n}\n\nmodule.bundle.Module = Module;\nvar checkedAssets, assetsToAccept;\n\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = process.env.HMR_HOSTNAME || location.hostname;\n  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + ':' + process.env.HMR_PORT + '/');\n  ws.onmessage = function(event) {\n    checkedAssets = {};\n    assetsToAccept = [];\n\n    var data = JSON.parse(event.data);\n\n    if (data.type === 'update') {\n      var handled = false;\n      data.assets.forEach(function(asset) {\n        if (!asset.isNew) {\n          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);\n          if (didAccept) {\n            handled = true;\n          }\n        }\n      });\n\n      // Enable HMR for CSS by default.\n      handled = handled || data.assets.every(function(asset) {\n        return asset.type === 'css' && asset.generated.js;\n      });\n\n      if (handled) {\n        console.clear();\n\n        data.assets.forEach(function (asset) {\n          hmrApply(global.parcelRequire, asset);\n        });\n\n        assetsToAccept.forEach(function (v) {\n          hmrAcceptRun(v[0], v[1]);\n        });\n      } else if (location.reload) { // `location` global exists in a web worker context but lacks `.reload()` function.\n        location.reload();\n      }\n    }\n\n    if (data.type === 'reload') {\n      ws.close();\n      ws.onclose = function () {\n        location.reload();\n      }\n    }\n\n    if (data.type === 'error-resolved') {\n      console.log('[parcel] ✨ Error resolved');\n\n      removeErrorOverlay();\n    }\n\n    if (data.type === 'error') {\n      console.error('[parcel] 🚨  ' + data.error.message + '\\n' + data.error.stack);\n\n      removeErrorOverlay();\n\n      var overlay = createErrorOverlay(data);\n      document.body.appendChild(overlay);\n    }\n  };\n}\n\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n  }\n}\n\nfunction createErrorOverlay(data) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n\n  // html encode message and stack trace\n  var message = document.createElement('div');\n  var stackTrace = document.createElement('pre');\n  message.innerText = data.error.message;\n  stackTrace.innerText = data.error.stack;\n\n  overlay.innerHTML = (\n    '<div style=\"background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;\">' +\n      '<span style=\"background: red; padding: 2px 4px; border-radius: 2px;\">ERROR</span>' +\n      '<span style=\"top: 2px; margin-left: 5px; position: relative;\">🚨</span>' +\n      '<div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">' + message.innerHTML + '</div>' +\n      '<pre>' + stackTrace.innerHTML + '</pre>' +\n    '</div>'\n  );\n\n  return overlay;\n\n}\n\nfunction getParents(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n\n  var parents = [];\n  var k, d, dep;\n\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || (Array.isArray(dep) && dep[dep.length - 1] === id)) {\n        parents.push(k);\n      }\n    }\n  }\n\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n\n  return parents;\n}\n\nfunction hmrApply(bundle, asset) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (modules[asset.id] || !bundle.parent) {\n    var fn = new Function('require', 'module', 'exports', asset.generated.js);\n    asset.isNew = !modules[asset.id];\n    modules[asset.id] = [fn, asset.deps];\n  } else if (bundle.parent) {\n    hmrApply(bundle.parent, asset);\n  }\n}\n\nfunction hmrAcceptCheck(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (!modules[id] && bundle.parent) {\n    return hmrAcceptCheck(bundle.parent, id);\n  }\n\n  if (checkedAssets[id]) {\n    return;\n  }\n  checkedAssets[id] = true;\n\n  var cached = bundle.cache[id];\n\n  assetsToAccept.push([bundle, id]);\n\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    return true;\n  }\n\n  return getParents(global.parcelRequire, id).some(function (id) {\n    return hmrAcceptCheck(global.parcelRequire, id)\n  });\n}\n\nfunction hmrAcceptRun(bundle, id) {\n  var cached = bundle.cache[id];\n  bundle.hotData = {};\n  if (cached) {\n    cached.hot.data = bundle.hotData;\n  }\n\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData);\n    });\n  }\n\n  delete bundle.cache[id];\n  bundle(id);\n\n  cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      cb();\n    });\n    return true;\n  }\n}\n"]}